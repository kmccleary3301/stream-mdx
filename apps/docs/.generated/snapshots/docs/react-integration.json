{
  "version": 1,
  "schemaId": "streammdx.snapshot.v1",
  "createdAt": "2026-02-11T20:33:50.409Z",
  "hash": "b08d2bebb82c571264d50a11b315619a230961f26731066168fafa34d48619ae",
  "contentHash": "fd4197d7d8d86e66e9da4897324e408cb9ab426da642444bb010d9e85bd5cb92",
  "configHash": "5bf7cb1869ac5e61e7413c355f3d9a0ee6aa384e6f0e17335aa19e78fb663148",
  "hashSalt": "docs-snapshots-v2:d595d42fa42edd94a867f74c48612ab7e5f488b9044579d7358c74b59edc856d",
  "blocks": [
    {
      "id": "db082c0",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "React Integration Guide ‚Äî StreamMDX",
        "range": {
          "from": 0,
          "to": 37
        },
        "meta": {
          "headingLevel": 1,
          "headingText": "React Integration Guide ‚Äî StreamMDX",
          "headingId": "react-integration-guide-streammdx"
        },
        "inline": [
          {
            "kind": "text",
            "text": "React Integration Guide ‚Äî StreamMDX"
          }
        ]
      }
    },
    {
      "id": "3961e41a",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Complete guide for React developers building streaming markdown experiences in web applications.**",
        "range": {
          "from": 39,
          "to": 139
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Complete guide for React developers building streaming markdown experiences in web applications."
              }
            ]
          }
        ]
      }
    },
    {
      "id": "2f3215fa",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 141,
          "to": 144
        }
      }
    },
    {
      "id": "7d13b97d",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Table of Contents",
        "range": {
          "from": 146,
          "to": 166
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Table of Contents",
          "headingId": "table-of-contents"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Table of Contents"
          }
        ]
      }
    },
    {
      "id": "6045c461",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "1. [Overview](#overview)\n2. [Quick Start](#quick-start)\n3. [Core Concepts](#core-concepts)\n4. [Basic Usage Patterns](#basic-usage-patterns)\n5. [Streaming from LLM/API](#streaming-from-llm-api)\n6. [Custom Components](#custom-components)\n7. [Custom Plugins](#custom-plugins)\n8. [MDX Integration](#mdx-integration)\n9. [Performance Optimization](#performance-optimization)\n10. [Common Patterns](#common-patterns)\n11. [Complete Examples](#complete-examples)\n12. [Troubleshooting](#troubleshooting)\n13. [Edge / No-worker Threads](#edge-no-worker-threads)",
        "range": {
          "from": 168,
          "to": 716
        },
        "meta": {
          "ordered": true,
          "items": [
            [
              {
                "kind": "link",
                "href": "#overview",
                "children": [
                  {
                    "kind": "text",
                    "text": "Overview"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#quick-start",
                "children": [
                  {
                    "kind": "text",
                    "text": "Quick Start"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#core-concepts",
                "children": [
                  {
                    "kind": "text",
                    "text": "Core Concepts"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#basic-usage-patterns",
                "children": [
                  {
                    "kind": "text",
                    "text": "Basic Usage Patterns"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#streaming-from-llm-api",
                "children": [
                  {
                    "kind": "text",
                    "text": "Streaming from LLM/API"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#custom-components",
                "children": [
                  {
                    "kind": "text",
                    "text": "Custom Components"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#custom-plugins",
                "children": [
                  {
                    "kind": "text",
                    "text": "Custom Plugins"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#mdx-integration",
                "children": [
                  {
                    "kind": "text",
                    "text": "MDX Integration"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#performance-optimization",
                "children": [
                  {
                    "kind": "text",
                    "text": "Performance Optimization"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#common-patterns",
                "children": [
                  {
                    "kind": "text",
                    "text": "Common Patterns"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#complete-examples",
                "children": [
                  {
                    "kind": "text",
                    "text": "Complete Examples"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#troubleshooting",
                "children": [
                  {
                    "kind": "text",
                    "text": "Troubleshooting"
                  }
                ]
              }
            ],
            [
              {
                "kind": "link",
                "href": "#edge-no-worker-threads",
                "children": [
                  {
                    "kind": "text",
                    "text": "Edge / No-worker Threads"
                  }
                ]
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "251c1a2a",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 718,
          "to": 721
        }
      }
    },
    {
      "id": "5ae847c8",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Overview",
        "range": {
          "from": 723,
          "to": 734
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Overview",
          "headingId": "overview"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Overview"
          }
        ]
      }
    },
    {
      "id": "7ed5c2",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "StreamMDX is a **high-performance, streaming-first React component** designed for real-time markdown rendering. Perfect for:",
        "range": {
          "from": 736,
          "to": 860
        },
        "inline": [
          {
            "kind": "text",
            "text": "StreamMDX is a "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "high-performance, streaming-first React component"
              }
            ]
          },
          {
            "kind": "text",
            "text": " designed for real-time markdown rendering. Perfect for:"
          }
        ]
      }
    },
    {
      "id": "2d30eac0",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- ‚úÖ **LLM chat interfaces** (Claude, ChatGPT-style streaming responses)\n- ‚úÖ **Live documentation** (streaming tutorials, guides)\n- ‚úÖ **Code editors** (markdown preview with syntax highlighting)\n- ‚úÖ **AI writing assistants** (real-time markdown composition)\n- ‚úÖ **Technical blogs** (streaming article rendering)",
        "range": {
          "from": 862,
          "to": 1172
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "‚úÖ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "LLM chat interfaces"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " (Claude, ChatGPT-style streaming responses)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "‚úÖ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Live documentation"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " (streaming tutorials, guides)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "‚úÖ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Code editors"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " (markdown preview with syntax highlighting)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "‚úÖ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "AI writing assistants"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " (real-time markdown composition)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "‚úÖ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Technical blogs"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " (streaming article rendering)"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "6e7f5103",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Key Features",
        "range": {
          "from": 1174,
          "to": 1190
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Key Features",
          "headingId": "key-features"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Key Features"
          }
        ]
      }
    },
    {
      "id": "3a73019d",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- üöÄ **Sub-16ms performance** ‚Äî Smooth 60Hz streaming updates\n- ‚ö° **Incremental rendering** ‚Äî Only updates the \"tail\" block, finalized blocks never re-render\n- üé® **Syntax highlighting** ‚Äî Shiki-powered code blocks with 200+ languages\n- üîå **Plugin system** ‚Äî Extensible inline and block processing\n- üõ°Ô∏è **Security-first** ‚Äî CSP-compliant, no `unsafe-eval`, Trusted Types support\n- üì¶ **Tree-shakable** ‚Äî Import only what you need",
        "range": {
          "from": 1192,
          "to": 1623
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "üöÄ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Sub-16ms performance"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî Smooth 60Hz streaming updates"
              }
            ],
            [
              {
                "kind": "text",
                "text": "‚ö° "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Incremental rendering"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî Only updates the \"tail\" block, finalized blocks never re-render"
              }
            ],
            [
              {
                "kind": "text",
                "text": "üé® "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Syntax highlighting"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî Shiki-powered code blocks with 200+ languages"
              }
            ],
            [
              {
                "kind": "text",
                "text": "üîå "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Plugin system"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî Extensible inline and block processing"
              }
            ],
            [
              {
                "kind": "text",
                "text": "üõ°Ô∏è "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Security-first"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî CSP-compliant, no "
              },
              {
                "kind": "code",
                "text": "unsafe-eval"
              },
              {
                "kind": "text",
                "text": ", Trusted Types support"
              }
            ],
            [
              {
                "kind": "text",
                "text": "üì¶ "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Tree-shakable"
                  }
                ]
              },
              {
                "kind": "text",
                "text": " ‚Äî Import only what you need"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "4c642c2c",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 1625,
          "to": 1628
        }
      }
    },
    {
      "id": "57c0ac42",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Quick Start",
        "range": {
          "from": 1630,
          "to": 1644
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Quick Start",
          "headingId": "quick-start"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Quick Start"
          }
        ]
      }
    },
    {
      "id": "3a5b4899",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Installation",
        "range": {
          "from": 1646,
          "to": 1662
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Installation",
          "headingId": "installation"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Installation"
          }
        ]
      }
    },
    {
      "id": "54e33de9",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```bash\nnpm install stream-mdx\n```",
        "range": {
          "from": 1664,
          "to": 1698
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"bash\"><code data-language=\"bash\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">npm</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> install</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> stream-mdx</span></span></code></pre>",
        "meta": {
          "lang": "bash",
          "code": "npm install stream-mdx"
        }
      }
    },
    {
      "id": "fc90ba6",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Worker bundle placement",
        "range": {
          "from": 1700,
          "to": 1727
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Worker bundle placement",
          "headingId": "worker-bundle-placement"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Worker bundle placement"
          }
        ]
      }
    },
    {
      "id": "7a6bff53",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "In production you should host the worker bundle from static assets (stricter CSP, no `blob:`).",
        "range": {
          "from": 1729,
          "to": 1823
        },
        "inline": [
          {
            "kind": "text",
            "text": "In production you should host the worker bundle from static assets (stricter CSP, no "
          },
          {
            "kind": "code",
            "text": "blob:"
          },
          {
            "kind": "text",
            "text": ")."
          }
        ]
      }
    },
    {
      "id": "20843c2a",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "After installing, copy the worker into your app:",
        "range": {
          "from": 1825,
          "to": 1873
        },
        "inline": [
          {
            "kind": "text",
            "text": "After installing, copy the worker into your app:"
          }
        ]
      }
    },
    {
      "id": "4e85d04b",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```bash\nmkdir -p public/workers\ncp node_modules/@stream-mdx/worker/dist/hosted/markdown-worker.js public/workers/markdown-worker.js\n```",
        "range": {
          "from": 1875,
          "to": 2010
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"bash\"><code data-language=\"bash\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">mkdir</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> -p</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> public/workers</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">cp</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> node_modules/@stream-mdx/worker/dist/hosted/markdown-worker.js</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> public/workers/markdown-worker.js</span></span></code></pre>",
        "meta": {
          "lang": "bash",
          "code": "mkdir -p public/workers\ncp node_modules/@stream-mdx/worker/dist/hosted/markdown-worker.js public/workers/markdown-worker.js"
        }
      }
    },
    {
      "id": "220c1cdf",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Minimal Example",
        "range": {
          "from": 2012,
          "to": 2031
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Minimal Example",
          "headingId": "minimal-example"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Minimal Example"
          }
        ]
      }
    },
    {
      "id": "2fb2997c",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function MyComponent() {\n  return (\n    <StreamingMarkdown\n      text=\"# Hello\\n\\nThis is **streaming** markdown!\"\n      worker=\"/workers/markdown-worker.js\"\n    />\n  );\n}\n```",
        "range": {
          "from": 2033,
          "to": 2271
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> MyComponent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"# Hello\\n\\nThis is **streaming** markdown!\"</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      worker</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/workers/markdown-worker.js\"</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nexport function MyComponent() {\n  return (\n    <StreamingMarkdown\n      text=\"# Hello\\n\\nThis is **streaming** markdown!\"\n      worker=\"/workers/markdown-worker.js\"\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "67feb41c",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**That's it!** You now have a streaming markdown renderer.",
        "range": {
          "from": 2273,
          "to": 2331
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "That's it!"
              }
            ]
          },
          {
            "kind": "text",
            "text": " You now have a streaming markdown renderer."
          }
        ]
      }
    },
    {
      "id": "5d918661",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "With Streaming",
        "range": {
          "from": 2333,
          "to": 2351
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "With Streaming",
          "headingId": "with-streaming"
        },
        "inline": [
          {
            "kind": "text",
            "text": "With Streaming"
          }
        ]
      }
    },
    {
      "id": "2edd6965",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nasync function* streamChunks(text: string) {\n  for (const word of text.split(\" \")) {\n    yield `${word} `;\n    await new Promise(resolve => setTimeout(resolve, 50));\n  }\n}\n\nexport function StreamingComponent({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      stream={streamChunks(text)}\n      worker=\"/workers/markdown-worker.js\"\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}\n```",
        "range": {
          "from": 2353,
          "to": 2819
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function*</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> streamChunks</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  for</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> word</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> of</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> text.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">split</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\" \"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">)) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    yield</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> `${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">word</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">} `</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    await</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> Promise</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">resolve</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setTimeout</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(resolve, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">50</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">));</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"9\"></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> StreamingComponent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">streamChunks</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(text)}</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      worker</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/workers/markdown-worker.js\"</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">]}</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nasync function* streamChunks(text: string) {\n  for (const word of text.split(\" \")) {\n    yield `${word} `;\n    await new Promise(resolve => setTimeout(resolve, 50));\n  }\n}\n\nexport function StreamingComponent({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      stream={streamChunks(text)}\n      worker=\"/workers/markdown-worker.js\"\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "2936b505",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Static / SSR Rendering (server-safe entrypoint)",
        "range": {
          "from": 2821,
          "to": 2872
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Static / SSR Rendering (server-safe entrypoint)",
          "headingId": "static-ssr-rendering-server-safe-entrypoint"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Static / SSR Rendering (server-safe entrypoint)"
          }
        ]
      }
    },
    {
      "id": "6c0a721d",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "For SSG/SSR, compile markdown once on the server and render blocks with the **server-safe** renderer entrypoint:",
        "range": {
          "from": 2874,
          "to": 2986
        },
        "inline": [
          {
            "kind": "text",
            "text": "For SSG/SSR, compile markdown once on the server and render blocks with the "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "server-safe"
              }
            ]
          },
          {
            "kind": "text",
            "text": " renderer entrypoint:"
          }
        ]
      }
    },
    {
      "id": "185b6f4d",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { MarkdownBlocksRenderer, ComponentRegistry } from \"@stream-mdx/react/server\";\nimport { compileMarkdownSnapshot } from \"@stream-mdx/worker/node\";\n\nexport async function ArticlePage() {\n  const { blocks } = await compileMarkdownSnapshot({\n    text: \"# Hello\\\\n\\\\n```ts\\\\nconsole.log('hi')\\\\n```\",\n    init: {\n      docPlugins: { tables: true, html: true, mdx: true, math: true, footnotes: true },\n      mdx: { compileMode: \"server\" },\n    },\n  });\n\n  const registry = new ComponentRegistry();\n  return <MarkdownBlocksRenderer blocks={blocks} componentRegistry={registry} />;\n}\n```",
        "range": {
          "from": 2988,
          "to": 3581
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { MarkdownBlocksRenderer, ComponentRegistry } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@stream-mdx/react/server\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { compileMarkdownSnapshot } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@stream-mdx/worker/node\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ArticlePage</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">blocks</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> compileMarkdownSnapshot</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    text: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"# Hello</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">n</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">n```ts</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">nconsole.log('hi')</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">n```\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    init: {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      docPlugins: { tables: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, html: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, math: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, footnotes: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      mdx: { compileMode: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"server\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    },</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  });</span></span>\n<span class=\"line\" data-line=\"12\"></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> registry</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ComponentRegistry</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">MarkdownBlocksRenderer</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> blocks</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{blocks} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">componentRegistry</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{registry} />;</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { MarkdownBlocksRenderer, ComponentRegistry } from \"@stream-mdx/react/server\";\nimport { compileMarkdownSnapshot } from \"@stream-mdx/worker/node\";\n\nexport async function ArticlePage() {\n  const { blocks } = await compileMarkdownSnapshot({\n    text: \"# Hello\\\\n\\\\n```ts\\\\nconsole.log('hi')\\\\n```\",\n    init: {\n      docPlugins: { tables: true, html: true, mdx: true, math: true, footnotes: true },\n      mdx: { compileMode: \"server\" },\n    },\n  });\n\n  const registry = new ComponentRegistry();\n  return <MarkdownBlocksRenderer blocks={blocks} componentRegistry={registry} />;\n}"
        }
      }
    },
    {
      "id": "547bc6dd",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Edge / No-worker Threads",
        "range": {
          "from": 3583,
          "to": 3611
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Edge / No-worker Threads",
          "headingId": "edge-no-worker-threads"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Edge / No-worker Threads"
          }
        ]
      }
    },
    {
      "id": "2a41487b",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "If your runtime cannot spawn `worker_threads`, use the direct compile surface and render\nthe returned blocks with the server-safe renderer:",
        "range": {
          "from": 3613,
          "to": 3752
        },
        "inline": [
          {
            "kind": "text",
            "text": "If your runtime cannot spawn "
          },
          {
            "kind": "code",
            "text": "worker_threads"
          },
          {
            "kind": "text",
            "text": ", use the direct compile surface and render\nthe returned blocks with the server-safe renderer:"
          }
        ]
      }
    },
    {
      "id": "6a091b7",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { MarkdownBlocksRenderer, ComponentRegistry } from \"@stream-mdx/react/server\";\nimport { compileMarkdownSnapshotDirect } from \"stream-mdx/worker/direct\";\n\nexport async function EdgeLikeArticlePage() {\n  const { blocks } = await compileMarkdownSnapshotDirect({\n    text: \"# Hello\\\\n\\\\nEdge-safe deterministic compile.\",\n    init: {\n      docPlugins: { tables: true, html: true, mdx: true, math: true, footnotes: true },\n      mdx: { compileMode: \"server\" },\n      prewarmLangs: [\"typescript\"],\n    },\n    cache: {\n      dir: \".stream-mdx-cache\",\n    },\n  });\n\n  return <MarkdownBlocksRenderer blocks={blocks} componentRegistry={new ComponentRegistry()} />;\n}\n```",
        "range": {
          "from": 3754,
          "to": 4428
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { MarkdownBlocksRenderer, ComponentRegistry } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@stream-mdx/react/server\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { compileMarkdownSnapshotDirect } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx/worker/direct\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> EdgeLikeArticlePage</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">blocks</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> compileMarkdownSnapshotDirect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    text: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"# Hello</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">n</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\\\</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">nEdge-safe deterministic compile.\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    init: {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      docPlugins: { tables: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, html: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, math: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, footnotes: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      mdx: { compileMode: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"server\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      prewarmLangs: [</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">],</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    },</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    cache: {</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      dir: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\".stream-mdx-cache\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    },</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  });</span></span>\n<span class=\"line\" data-line=\"16\"></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">MarkdownBlocksRenderer</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> blocks</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{blocks} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">componentRegistry</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ComponentRegistry</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">()} />;</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { MarkdownBlocksRenderer, ComponentRegistry } from \"@stream-mdx/react/server\";\nimport { compileMarkdownSnapshotDirect } from \"stream-mdx/worker/direct\";\n\nexport async function EdgeLikeArticlePage() {\n  const { blocks } = await compileMarkdownSnapshotDirect({\n    text: \"# Hello\\\\n\\\\nEdge-safe deterministic compile.\",\n    init: {\n      docPlugins: { tables: true, html: true, mdx: true, math: true, footnotes: true },\n      mdx: { compileMode: \"server\" },\n      prewarmLangs: [\"typescript\"],\n    },\n    cache: {\n      dir: \".stream-mdx-cache\",\n    },\n  });\n\n  return <MarkdownBlocksRenderer blocks={blocks} componentRegistry={new ComponentRegistry()} />;\n}"
        }
      }
    },
    {
      "id": "2b4ba69d",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "Cache note:",
        "range": {
          "from": 4430,
          "to": 4441
        },
        "inline": [
          {
            "kind": "text",
            "text": "Cache note:"
          }
        ]
      }
    },
    {
      "id": "4e815642",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- In Node-like environments, direct compile reads/writes the same snapshot cache contract as `compileMarkdownSnapshot`.\n- In edge isolates without filesystem APIs, compile still works and skips cache IO.",
        "range": {
          "from": 4442,
          "to": 4645
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "In Node-like environments, direct compile reads/writes the same snapshot cache contract as "
              },
              {
                "kind": "code",
                "text": "compileMarkdownSnapshot"
              },
              {
                "kind": "text",
                "text": "."
              }
            ],
            [
              {
                "kind": "text",
                "text": "In edge isolates without filesystem APIs, compile still works and skips cache IO."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "14cc0a51",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 4647,
          "to": 4650
        }
      }
    },
    {
      "id": "7ff15c9f",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Core Concepts",
        "range": {
          "from": 4652,
          "to": 4668
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Core Concepts",
          "headingId": "core-concepts"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Core Concepts"
          }
        ]
      }
    },
    {
      "id": "3ffb60db",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Architecture",
        "range": {
          "from": 4670,
          "to": 4686
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Architecture",
          "headingId": "architecture"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Architecture"
          }
        ]
      }
    },
    {
      "id": "277617e8",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```\n[LLM Stream] ‚Üí [Web Worker] ‚Üí [React Component] ‚Üí [DOM]\n     ‚îÇ              ‚îÇ                ‚îÇ              ‚îÇ\n  append()      parse()         <StreamingMarkdown>  render\n```",
        "range": {
          "from": 4688,
          "to": 4865
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"text\"><code data-language=\"text\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span>[LLM Stream] ‚Üí [Web Worker] ‚Üí [React Component] ‚Üí [DOM]</span></span>\n<span class=\"line\" data-line=\"2\"><span>     ‚îÇ              ‚îÇ                ‚îÇ              ‚îÇ</span></span>\n<span class=\"line\" data-line=\"3\"><span>  append()      parse()         &#x3C;StreamingMarkdown>  render</span></span></code></pre>",
        "meta": {
          "lang": "text",
          "code": "[LLM Stream] ‚Üí [Web Worker] ‚Üí [React Component] ‚Üí [DOM]\n     ‚îÇ              ‚îÇ                ‚îÇ              ‚îÇ\n  append()      parse()         <StreamingMarkdown>  render"
        }
      }
    },
    {
      "id": "7ca5a1bb",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Key Props",
        "range": {
          "from": 4867,
          "to": 4880
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Key Props",
          "headingId": "key-props"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Key Props"
          }
        ]
      }
    },
    {
      "id": "5d099302",
      "type": "table",
      "isFinalized": true,
      "payload": {
        "raw": "| Prop | Type | Description |\n|------|------|-------------|\n| `text` | `string` | Static markdown content. Changing it restarts the session. |\n| `stream` | `AsyncIterable<string>` | Streaming markdown chunks. Use for live updates. |\n| `worker` | `Worker \\| URL \\| string \\| () => Worker` | Worker instance/URL/factory. Recommended: `\"/workers/markdown-worker.js\"`. |\n| `features` | `object` | Feature flags: `{ math?, mdx?, tables?, html?, callouts?, footnotes?, formatAnticipation?, codeHighlighting? }` |\n| `mdxCompileMode` | `\"server\" \\| \"worker\"` | Enables MDX compilation/hydration and selects strategy. |\n| `mdxComponents` | `object` | Component map passed to hydrated MDX blocks. |\n| `components` | `object` | Override block components (headings, code, tables, etc.). |\n| `inlineComponents` | `object` | Override inline components (bold, links, code, etc.). |\n| `tableElements` | `object` | Override table tags (Shadcn table wrappers, etc.). |\n| `htmlElements` | `object` | Override HTML tag renders (when HTML is enabled). |\n| `prewarmLangs` | `string[]` | Shiki languages to load upfront. |\n| `scheduling` | `object` | Patch scheduler/backpressure knobs. |\n| `managedWorker` | `boolean` | When `true`, you drive `append/finalize` via the ref handle. |\n| `onMetrics` | `function` | Performance metrics callback after each flush. |\n| `onError` | `function` | Render-time error callback. |",
        "range": {
          "from": 4882,
          "to": 6277
        },
        "inline": [],
        "meta": {
          "header": [
            [
              {
                "kind": "text",
                "text": "Prop"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Type"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Description"
              }
            ]
          ],
          "rows": [
            [
              [
                {
                  "kind": "code",
                  "text": "text"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "string"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Static markdown content. Changing it restarts the session."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "stream"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "AsyncIterable<string>"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Streaming markdown chunks. Use for live updates."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "worker"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "`Worker \\"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "URL \\"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "string \\"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "() => Worker`"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Worker instance/URL/factory. Recommended: "
                },
                {
                  "kind": "code",
                  "text": "\"/workers/markdown-worker.js\""
                },
                {
                  "kind": "text",
                  "text": "."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "features"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Feature flags: "
                },
                {
                  "kind": "code",
                  "text": "{ math?, mdx?, tables?, html?, callouts?, footnotes?, formatAnticipation?, codeHighlighting? }"
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "mdxCompileMode"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "`\"server\" \\"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "\"worker\"`"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Enables MDX compilation/hydration and selects strategy."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "mdxComponents"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Component map passed to hydrated MDX blocks."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "components"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Override block components (headings, code, tables, etc.)."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "inlineComponents"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Override inline components (bold, links, code, etc.)."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "tableElements"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Override table tags (Shadcn table wrappers, etc.)."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "htmlElements"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Override HTML tag renders (when HTML is enabled)."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "prewarmLangs"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "string[]"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Shiki languages to load upfront."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "scheduling"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "object"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Patch scheduler/backpressure knobs."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "managedWorker"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "boolean"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "When "
                },
                {
                  "kind": "code",
                  "text": "true"
                },
                {
                  "kind": "text",
                  "text": ", you drive "
                },
                {
                  "kind": "code",
                  "text": "append/finalize"
                },
                {
                  "kind": "text",
                  "text": " via the ref handle."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "onMetrics"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "function"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Performance metrics callback after each flush."
                }
              ]
            ],
            [
              [
                {
                  "kind": "code",
                  "text": "onError"
                }
              ],
              [
                {
                  "kind": "code",
                  "text": "function"
                }
              ],
              [
                {
                  "kind": "text",
                  "text": "Render-time error callback."
                }
              ]
            ]
          ],
          "align": [
            null,
            null,
            null
          ]
        }
      }
    },
    {
      "id": "3233c79e",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Streaming Behavior",
        "range": {
          "from": 6279,
          "to": 6301
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Streaming Behavior",
          "headingId": "streaming-behavior"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Streaming Behavior"
          }
        ]
      }
    },
    {
      "id": "5fbdb984",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- **Single dirty tail**: Only the last block updates during streaming\n- **Finalized blocks**: Once finalized, blocks never re-render (stable keys)\n- **Incremental parsing**: Worker parses only new content, not the entire document\n- **Patch-based updates**: Efficient updates via patch operations",
        "range": {
          "from": 6303,
          "to": 6598
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Single dirty tail"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": Only the last block updates during streaming"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Finalized blocks"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": Once finalized, blocks never re-render (stable keys)"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Incremental parsing"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": Worker parses only new content, not the entire document"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Patch-based updates"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": Efficient updates via patch operations"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "54c4df94",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 6600,
          "to": 6603
        }
      }
    },
    {
      "id": "794d413b",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Basic Usage Patterns",
        "range": {
          "from": 6605,
          "to": 6628
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Basic Usage Patterns",
          "headingId": "basic-usage-patterns"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Basic Usage Patterns"
          }
        ]
      }
    },
    {
      "id": "7e38e71d",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 1: Static Content",
        "range": {
          "from": 6630,
          "to": 6659
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 1: Static Content",
          "headingId": "pattern-1-static-content"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 1: Static Content"
          }
        ]
      }
    },
    {
      "id": "74ab9cc1",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nconst article = `\n# My Article\n\nThis is a **static** article that renders immediately.\n\n\\`\\`\\`typescript\nconst hello = \"world\";\n\\`\\`\\`\n`;\n\nexport function Article() {\n  return <StreamingMarkdown text={article} />;\n}\n```",
        "range": {
          "from": 6661,
          "to": 6936
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> article</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> `</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"># My Article</span></span>\n<span class=\"line\" data-line=\"5\"></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">This is a **static** article that renders immediately.</span></span>\n<span class=\"line\" data-line=\"7\"></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\`\\`\\`</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">typescript</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">const hello = \"world\";</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\`\\`\\`</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"12\"></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Article</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{article} />;</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nconst article = `\n# My Article\n\nThis is a **static** article that renders immediately.\n\n\\`\\`\\`typescript\nconst hello = \"world\";\n\\`\\`\\`\n`;\n\nexport function Article() {\n  return <StreamingMarkdown text={article} />;\n}"
        }
      }
    },
    {
      "id": "20f58898",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 2: Controlled Updates",
        "range": {
          "from": 6938,
          "to": 6971
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 2: Controlled Updates",
          "headingId": "pattern-2-controlled-updates"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 2: Controlled Updates"
          }
        ]
      }
    },
    {
      "id": "4b829a5",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function Editor() {\n  const [markdown, setMarkdown] = useState(\"\");\n\n  return (\n    <div>\n      <textarea\n        value={markdown}\n        onChange={(e) => setMarkdown(e.target.value)}\n        placeholder=\"Type markdown here...\"\n      />\n      <StreamingMarkdown text={markdown} />\n    </div>\n  );\n}\n```",
        "range": {
          "from": 6973,
          "to": 7373
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Editor</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">markdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">textarea</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        value</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{markdown}</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        onChange</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">e</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(e.target.value)}</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        placeholder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Type markdown here...\"</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      /></span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{markdown} /></span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function Editor() {\n  const [markdown, setMarkdown] = useState(\"\");\n\n  return (\n    <div>\n      <textarea\n        value={markdown}\n        onChange={(e) => setMarkdown(e.target.value)}\n        placeholder=\"Type markdown here...\"\n      />\n      <StreamingMarkdown text={markdown} />\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "7db863ba",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 3: Streaming from State",
        "range": {
          "from": 7375,
          "to": 7410
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 3: Streaming from State",
          "headingId": "pattern-3-streaming-from-state"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 3: Streaming from State"
          }
        ]
      }
    },
    {
      "id": "490c28dc",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState, useEffect } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function StreamingView() {\n  const [content, setContent] = useState(\"\");\n\n  useEffect(() => {\n    // Simulate streaming\n    const words = \"This is a streaming response that appears word by word.\";\n    let index = 0;\n    \n    const interval = setInterval(() => {\n      if (index < words.length) {\n        setContent(prev => prev + words[index]);\n        index++;\n      } else {\n        clearInterval(interval);\n      }\n    }, 50);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return <StreamingMarkdown text={content} />;\n}\n```",
        "range": {
          "from": 7412,
          "to": 8056
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState, useEffect } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> StreamingView</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">content</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Simulate streaming</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> words</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"This is a streaming response that appears word by word.\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    let</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> index </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 0</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    </span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> interval</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (index </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x3C;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> words.</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">length</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> prev </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> words[index]);</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        index</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">++</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">else</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        clearInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(interval);</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      }</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">50</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"20\"></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> () </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> clearInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(interval);</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, []);</span></span>\n<span class=\"line\" data-line=\"23\"></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content} />;</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState, useEffect } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function StreamingView() {\n  const [content, setContent] = useState(\"\");\n\n  useEffect(() => {\n    // Simulate streaming\n    const words = \"This is a streaming response that appears word by word.\";\n    let index = 0;\n    \n    const interval = setInterval(() => {\n      if (index < words.length) {\n        setContent(prev => prev + words[index]);\n        index++;\n      } else {\n        clearInterval(interval);\n      }\n    }, 50);\n\n    return () => clearInterval(interval);\n  }, []);\n\n  return <StreamingMarkdown text={content} />;\n}"
        }
      }
    },
    {
      "id": "4b61a527",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 8058,
          "to": 8061
        }
      }
    },
    {
      "id": "56165e4b",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Streaming from LLM/API",
        "range": {
          "from": 8063,
          "to": 8088
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Streaming from LLM/API",
          "headingId": "streaming-from-llm-api"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Streaming from LLM/API"
          }
        ]
      }
    },
    {
      "id": "360757f1",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 1: Fetch Stream",
        "range": {
          "from": 8090,
          "to": 8117
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 1: Fetch Stream",
          "headingId": "pattern-1-fetch-stream"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 1: Fetch Stream"
          }
        ]
      }
    },
    {
      "id": "4e610267",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useEffect, useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nasync function* streamFromAPI(prompt: string) {\n  const response = await fetch(\"/api/llm/stream\", {\n    method: \"POST\",\n    body: JSON.stringify({ prompt }),\n  });\n\n  const reader = response.body!.getReader();\n  const decoder = new TextDecoder();\n\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n    \n    const chunk = decoder.decode(value, { stream: true });\n    yield chunk;\n  }\n}\n\nexport function LLMResponse({ prompt }: { prompt: string }) {\n  const [stream, setStream] = useState<AsyncIterable<string> | null>(null);\n\n  useEffect(() => {\n    const s = streamFromAPI(prompt);\n    setStream(s);\n  }, [prompt]);\n\n  if (!stream) return <div>Loading...</div>;\n\n  return (\n    <StreamingMarkdown\n      stream={stream}\n      prewarmLangs={[\"typescript\", \"bash\", \"python\"]}\n    />\n  );\n}\n```",
        "range": {
          "from": 8119,
          "to": 9047
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useEffect, useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function*</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> streamFromAPI</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prompt</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> response</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> fetch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/api/llm/stream\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, {</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    method: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"POST\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    body: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">JSON</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">stringify</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ prompt }),</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  });</span></span>\n<span class=\"line\" data-line=\"9\"></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> reader</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> response.body</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">getReader</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> decoder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> TextDecoder</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"12\"></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  while</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">done</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">value</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> reader.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">read</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (done) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">break</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    </span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> chunk</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> decoder.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">decode</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(value, { stream: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> });</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    yield</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> chunk;</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"21\"></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> LLMResponse</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prompt</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prompt</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">stream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setStream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">AsyncIterable</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">|</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"24\"></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> s</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> streamFromAPI</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(prompt);</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setStream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(s);</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, [prompt]);</span></span>\n<span class=\"line\" data-line=\"29\"></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">stream) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>Loading...&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>;</span></span>\n<span class=\"line\" data-line=\"31\"></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{stream}</span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"python\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">]}</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useEffect, useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nasync function* streamFromAPI(prompt: string) {\n  const response = await fetch(\"/api/llm/stream\", {\n    method: \"POST\",\n    body: JSON.stringify({ prompt }),\n  });\n\n  const reader = response.body!.getReader();\n  const decoder = new TextDecoder();\n\n  while (true) {\n    const { done, value } = await reader.read();\n    if (done) break;\n    \n    const chunk = decoder.decode(value, { stream: true });\n    yield chunk;\n  }\n}\n\nexport function LLMResponse({ prompt }: { prompt: string }) {\n  const [stream, setStream] = useState<AsyncIterable<string> | null>(null);\n\n  useEffect(() => {\n    const s = streamFromAPI(prompt);\n    setStream(s);\n  }, [prompt]);\n\n  if (!stream) return <div>Loading...</div>;\n\n  return (\n    <StreamingMarkdown\n      stream={stream}\n      prewarmLangs={[\"typescript\", \"bash\", \"python\"]}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "42a2fedc",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 2: WebSocket Stream",
        "range": {
          "from": 9049,
          "to": 9080
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 2: WebSocket Stream",
          "headingId": "pattern-2-websocket-stream"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 2: WebSocket Stream"
          }
        ]
      }
    },
    {
      "id": "445bf229",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useEffect, useState, useRef } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function WebSocketStream({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n  const wsRef = useRef<WebSocket | null>(null);\n\n  useEffect(() => {\n    const ws = new WebSocket(url);\n    wsRef.current = ws;\n\n    ws.onmessage = (event) => {\n      setContent(prev => prev + event.data);\n    };\n\n    return () => {\n      ws.close();\n    };\n  }, [url]);\n\n  return (\n    <StreamingMarkdown\n      text={content}\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}\n```",
        "range": {
          "from": 9082,
          "to": 9685
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useEffect, useState, useRef } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> WebSocketStream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">content</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> wsRef</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useRef</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">WebSocket</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"7\"></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> ws</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> WebSocket</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(url);</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    wsRef.current </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> ws;</span></span>\n<span class=\"line\" data-line=\"11\"></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    ws.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">onmessage</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">event</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> prev </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> event.data);</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    };</span></span>\n<span class=\"line\" data-line=\"15\"></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> () </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      ws.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">close</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    };</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, [url]);</span></span>\n<span class=\"line\" data-line=\"20\"></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">]}</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useEffect, useState, useRef } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function WebSocketStream({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n  const wsRef = useRef<WebSocket | null>(null);\n\n  useEffect(() => {\n    const ws = new WebSocket(url);\n    wsRef.current = ws;\n\n    ws.onmessage = (event) => {\n      setContent(prev => prev + event.data);\n    };\n\n    return () => {\n      ws.close();\n    };\n  }, [url]);\n\n  return (\n    <StreamingMarkdown\n      text={content}\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "689c15dc",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 3: SSE (Server-Sent Events)",
        "range": {
          "from": 9687,
          "to": 9726
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 3: SSE (Server-Sent Events)",
          "headingId": "pattern-3-sse-server-sent-events"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 3: SSE (Server-Sent Events)"
          }
        ]
      }
    },
    {
      "id": "17a4238a",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useEffect, useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function SSEStream({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n\n  useEffect(() => {\n    const eventSource = new EventSource(url);\n\n    eventSource.onmessage = (event) => {\n      setContent(prev => prev + event.data);\n    };\n\n    return () => {\n      eventSource.close();\n    };\n  }, [url]);\n\n  return (\n    <StreamingMarkdown\n      text={content}\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}\n```",
        "range": {
          "from": 9728,
          "to": 10274
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useEffect, useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> SSEStream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">content</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> eventSource</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> EventSource</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(url);</span></span>\n<span class=\"line\" data-line=\"9\"></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    eventSource.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">onmessage</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">event</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> prev </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> event.data);</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    };</span></span>\n<span class=\"line\" data-line=\"13\"></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> () </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      eventSource.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">close</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    };</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, [url]);</span></span>\n<span class=\"line\" data-line=\"18\"></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">]}</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useEffect, useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function SSEStream({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n\n  useEffect(() => {\n    const eventSource = new EventSource(url);\n\n    eventSource.onmessage = (event) => {\n      setContent(prev => prev + event.data);\n    };\n\n    return () => {\n      eventSource.close();\n    };\n  }, [url]);\n\n  return (\n    <StreamingMarkdown\n      text={content}\n      prewarmLangs={[\"typescript\", \"bash\"]}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "351a0b22",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 4: Chat Interface (Multiple Messages)",
        "range": {
          "from": 10276,
          "to": 10325
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 4: Chat Interface (Multiple Messages)",
          "headingId": "pattern-4-chat-interface-multiple-messages"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 4: Chat Interface (Multiple Messages)"
          }
        ]
      }
    },
    {
      "id": "69f4aec5",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState } from \"react\";\nimport { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  isStreaming?: boolean;\n}\n\nexport function ChatInterface() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [currentStreaming, setCurrentStreaming] = useState<string>(\"\");\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n\n  async function sendMessage(text: string) {\n    // Add user message\n    setMessages(prev => [...prev, {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: text,\n    }]);\n\n    // Start streaming assistant response\n    setCurrentStreaming(\"\");\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: text }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let assistantContent = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n\n      const chunk = decoder.decode(value, { stream: true });\n      assistantContent += chunk;\n      setCurrentStreaming(assistantContent);\n    }\n\n    // Finalize message\n    setMessages(prev => [...prev, {\n      id: (Date.now() + 1).toString(),\n      role: \"assistant\",\n      content: assistantContent,\n    }]);\n    setCurrentStreaming(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      {messages.map(msg => (\n        <div key={msg.id} className={`message ${msg.role}`}>\n          <StreamingMarkdown text={msg.content} />\n        </div>\n      ))}\n      \n      {currentStreaming && (\n        <div className=\"message assistant streaming\">\n          <StreamingMarkdown text={currentStreaming} />\n        </div>\n      )}\n    </div>\n  );\n}\n```",
        "range": {
          "from": 10327,
          "to": 12132
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> StreamingMarkdownHandle } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">interface</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Message</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  role</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"user\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"assistant\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  content</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  isStreaming</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">?:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> boolean</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"10\"></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ChatInterface</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">messages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">Message</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">[]>([]);</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">currentStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setCurrentStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> handleRef</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useRef</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">StreamingMarkdownHandle</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"15\"></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> sendMessage</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Add user message</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, {</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      id: Date.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">now</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">().</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">toString</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(),</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"user\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content: text,</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }]);</span></span>\n<span class=\"line\" data-line=\"23\"></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Start streaming assistant response</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setCurrentStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> response</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> fetch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/api/chat\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, {</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      method: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"POST\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      body: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">JSON</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">stringify</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ message: text }),</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    });</span></span>\n<span class=\"line\" data-line=\"30\"></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> reader</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> response.body</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">getReader</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> decoder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> TextDecoder</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    let</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> assistantContent </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"34\"></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    while</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">done</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">value</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> reader.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">read</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (done) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">break</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"38\"></span>\n<span class=\"line\" data-line=\"39\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> chunk</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> decoder.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">decode</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(value, { stream: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> });</span></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      assistantContent </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> chunk;</span></span>\n<span class=\"line\" data-line=\"41\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      setCurrentStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(assistantContent);</span></span>\n<span class=\"line\" data-line=\"42\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }</span></span>\n<span class=\"line\" data-line=\"43\"></span>\n<span class=\"line\" data-line=\"44\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Finalize message</span></span>\n<span class=\"line\" data-line=\"45\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, {</span></span>\n<span class=\"line\" data-line=\"46\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      id: (Date.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">now</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 1</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">).</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">toString</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(),</span></span>\n<span class=\"line\" data-line=\"47\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"assistant\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"48\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content: assistantContent,</span></span>\n<span class=\"line\" data-line=\"49\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }]);</span></span>\n<span class=\"line\" data-line=\"50\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setCurrentStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"51\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"52\"></span>\n<span class=\"line\" data-line=\"53\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"54\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"chat-container\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"55\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {messages.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">map</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">msg</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"56\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> key</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{msg.id} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`message ${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">msg</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">role</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}></span></span>\n<span class=\"line\" data-line=\"57\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{msg.content} /></span></span>\n<span class=\"line\" data-line=\"58\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"59\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      ))}</span></span>\n<span class=\"line\" data-line=\"60\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      </span></span>\n<span class=\"line\" data-line=\"61\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {currentStreaming </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"62\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"message assistant streaming\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"63\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{currentStreaming} /></span></span>\n<span class=\"line\" data-line=\"64\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"65\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      )}</span></span>\n<span class=\"line\" data-line=\"66\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"67\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"68\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState } from \"react\";\nimport { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  isStreaming?: boolean;\n}\n\nexport function ChatInterface() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [currentStreaming, setCurrentStreaming] = useState<string>(\"\");\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n\n  async function sendMessage(text: string) {\n    // Add user message\n    setMessages(prev => [...prev, {\n      id: Date.now().toString(),\n      role: \"user\",\n      content: text,\n    }]);\n\n    // Start streaming assistant response\n    setCurrentStreaming(\"\");\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: text }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let assistantContent = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n\n      const chunk = decoder.decode(value, { stream: true });\n      assistantContent += chunk;\n      setCurrentStreaming(assistantContent);\n    }\n\n    // Finalize message\n    setMessages(prev => [...prev, {\n      id: (Date.now() + 1).toString(),\n      role: \"assistant\",\n      content: assistantContent,\n    }]);\n    setCurrentStreaming(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      {messages.map(msg => (\n        <div key={msg.id} className={`message ${msg.role}`}>\n          <StreamingMarkdown text={msg.content} />\n        </div>\n      ))}\n      \n      {currentStreaming && (\n        <div className=\"message assistant streaming\">\n          <StreamingMarkdown text={currentStreaming} />\n        </div>\n      )}\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "6ab3fd03",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 12134,
          "to": 12137
        }
      }
    },
    {
      "id": "64bfd45a",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Custom Components",
        "range": {
          "from": 12139,
          "to": 12159
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Custom Components",
          "headingId": "custom-components"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Custom Components"
          }
        ]
      }
    },
    {
      "id": "2a06f905",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Override Block Components",
        "range": {
          "from": 12161,
          "to": 12190
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Override Block Components",
          "headingId": "override-block-components"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Override Block Components"
          }
        ]
      }
    },
    {
      "id": "5895392b",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport type { BlockComponents } from \"stream-mdx\";\n\nconst customComponents: Partial<BlockComponents> = {\n  heading: ({ level, children, ...props }) => {\n    const Tag = `h${level}` as keyof JSX.IntrinsicElements;\n    return (\n      <Tag \n        {...props}\n        className=\"scroll-m-20 text-3xl font-bold mb-4\"\n        id={`heading-${level}`}\n      >\n        {children}\n      </Tag>\n    );\n  },\n\n  code: ({ html, meta, ...props }) => {\n    const lang = meta?.lang as string | undefined;\n    return (\n      <div className=\"code-block-wrapper\">\n        <div className=\"code-header\">\n          <span className=\"language\">{lang || \"text\"}</span>\n          <button\n            onClick={() => {\n              navigator.clipboard.writeText(meta?.rawCode as string || \"\");\n            }}\n          >\n            Copy\n          </button>\n        </div>\n        <div\n          className=\"code-content\"\n          dangerouslySetInnerHTML={{ __html: html || \"\" }}\n        />\n      </div>\n    );\n  },\n\n  paragraph: ({ children, ...props }) => (\n    <p {...props} className=\"mb-4 leading-relaxed\">\n      {children}\n    </p>\n  ),\n};\n\nexport function CustomStyledMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      components={customComponents}\n    />\n  );\n}\n```",
        "range": {
          "from": 12192,
          "to": 13539
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { BlockComponents } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> customComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Partial</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">BlockComponents</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  heading</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">level</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> Tag</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> `h${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">level</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> as</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> keyof</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> JSX</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">IntrinsicElements</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Tag</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> </span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props}</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"scroll-m-20 text-3xl font-bold mb-4\"</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`heading-${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">level</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      ></span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        {children}</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Tag</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    );</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  },</span></span>\n<span class=\"line\" data-line=\"17\"></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  code</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">html</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">meta</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> lang</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> meta?.lang </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">as</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> undefined</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"code-block-wrapper\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"code-header\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">span</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"language\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>{lang </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"text\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">span</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">            onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">              navigator.clipboard.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">writeText</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(meta?.rawCode </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">as</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> ||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            }}</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          ></span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            Copy</span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"code-content\"</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          dangerouslySetInnerHTML</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ __html: html </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        /></span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    );</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  },</span></span>\n<span class=\"line\" data-line=\"39\"></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  paragraph</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"41\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">p</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"mb-4 leading-relaxed\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"42\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {children}</span></span>\n<span class=\"line\" data-line=\"43\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">p</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"44\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"45\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"46\"></span>\n<span class=\"line\" data-line=\"47\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> CustomStyledMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"48\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"49\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"50\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"51\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      components</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{customComponents}</span></span>\n<span class=\"line\" data-line=\"52\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"53\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"54\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport type { BlockComponents } from \"stream-mdx\";\n\nconst customComponents: Partial<BlockComponents> = {\n  heading: ({ level, children, ...props }) => {\n    const Tag = `h${level}` as keyof JSX.IntrinsicElements;\n    return (\n      <Tag \n        {...props}\n        className=\"scroll-m-20 text-3xl font-bold mb-4\"\n        id={`heading-${level}`}\n      >\n        {children}\n      </Tag>\n    );\n  },\n\n  code: ({ html, meta, ...props }) => {\n    const lang = meta?.lang as string | undefined;\n    return (\n      <div className=\"code-block-wrapper\">\n        <div className=\"code-header\">\n          <span className=\"language\">{lang || \"text\"}</span>\n          <button\n            onClick={() => {\n              navigator.clipboard.writeText(meta?.rawCode as string || \"\");\n            }}\n          >\n            Copy\n          </button>\n        </div>\n        <div\n          className=\"code-content\"\n          dangerouslySetInnerHTML={{ __html: html || \"\" }}\n        />\n      </div>\n    );\n  },\n\n  paragraph: ({ children, ...props }) => (\n    <p {...props} className=\"mb-4 leading-relaxed\">\n      {children}\n    </p>\n  ),\n};\n\nexport function CustomStyledMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      components={customComponents}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "48aa9520",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Mermaid Diagrams (Optional)",
        "range": {
          "from": 13541,
          "to": 13572
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Mermaid Diagrams (Optional)",
          "headingId": "mermaid-diagrams-optional"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Mermaid Diagrams (Optional)"
          }
        ]
      }
    },
    {
      "id": "60b77328",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "StreamMDX treats fenced ` ```mermaid ` code blocks as normal code blocks by default.",
        "range": {
          "from": 13574,
          "to": 13658
        },
        "inline": [
          {
            "kind": "text",
            "text": "StreamMDX treats fenced "
          },
          {
            "kind": "code",
            "text": " "
          },
          {
            "kind": "text",
            "text": "`"
          },
          {
            "kind": "code",
            "text": "mermaid "
          },
          {
            "kind": "text",
            "text": " code blocks as normal code blocks by default."
          }
        ]
      }
    },
    {
      "id": "328722f6",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "To render Mermaid diagrams (with a Diagram/Code toggle), install the add-on and register the `mermaid` block component:",
        "range": {
          "from": 13660,
          "to": 13779
        },
        "inline": [
          {
            "kind": "text",
            "text": "To render Mermaid diagrams (with a Diagram/Code toggle), install the add-on and register the "
          },
          {
            "kind": "code",
            "text": "mermaid"
          },
          {
            "kind": "text",
            "text": " block component:"
          }
        ]
      }
    },
    {
      "id": "2585a186",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```bash\nnpm install @stream-mdx/mermaid\n```",
        "range": {
          "from": 13781,
          "to": 13824
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"bash\"><code data-language=\"bash\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">npm</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> install</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> @stream-mdx/mermaid</span></span></code></pre>",
        "meta": {
          "lang": "bash",
          "code": "npm install @stream-mdx/mermaid"
        }
      }
    },
    {
      "id": "5889a5fa",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport { MermaidBlock } from \"@stream-mdx/mermaid\";\n\nexport function MermaidDemo({ text }: { text: string }) {\n  return <StreamingMarkdown text={text} components={{ mermaid: MermaidBlock }} />;\n}\n```",
        "range": {
          "from": 13826,
          "to": 14080
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { MermaidBlock } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@stream-mdx/mermaid\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> MermaidDemo</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">components</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ mermaid: MermaidBlock }} />;</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport { MermaidBlock } from \"@stream-mdx/mermaid\";\n\nexport function MermaidDemo({ text }: { text: string }) {\n  return <StreamingMarkdown text={text} components={{ mermaid: MermaidBlock }} />;\n}"
        }
      }
    },
    {
      "id": "49808a31",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "The Code view uses the same optimized code rendering path (including incremental updates and virtualization) because StreamMDX passes the standard code renderer into the Mermaid component.",
        "range": {
          "from": 14082,
          "to": 14270
        },
        "inline": [
          {
            "kind": "text",
            "text": "The Code view uses the same optimized code rendering path (including incremental updates and virtualization) because StreamMDX passes the standard code renderer into the Mermaid component."
          }
        ]
      }
    },
    {
      "id": "2cee49a",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Override Inline Components",
        "range": {
          "from": 14272,
          "to": 14302
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Override Inline Components",
          "headingId": "override-inline-components"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Override Inline Components"
          }
        ]
      }
    },
    {
      "id": "78320ce0",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport type { InlineComponents } from \"stream-mdx\";\n\nconst customInlineComponents: Partial<InlineComponents> = {\n  strong: ({ children }) => (\n    <strong className=\"font-bold text-primary\">{children}</strong>\n  ),\n\n  em: ({ children }) => (\n    <em className=\"italic text-muted-foreground\">{children}</em>\n  ),\n\n  code: ({ children }) => (\n    <code className=\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono\">\n      {children}\n    </code>\n  ),\n\n  link: ({ href, children }) => (\n    <a\n      href={href}\n      className=\"text-blue-600 hover:underline\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      {children}\n    </a>\n  ),\n};\n\nexport function CustomInlineMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      inlineComponents={customInlineComponents}\n    />\n  );\n}\n```",
        "range": {
          "from": 14304,
          "to": 15193
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { InlineComponents } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> customInlineComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Partial</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">InlineComponents</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  strong</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">strong</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"font-bold text-primary\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>{children}&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">strong</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"8\"></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  em</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">em</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"italic text-muted-foreground\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>{children}&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">em</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"12\"></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  code</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">code</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {children}</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">code</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"18\"></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  link</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">href</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">a</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      href</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{href}</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"text-blue-600 hover:underline\"</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      target</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"_blank\"</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      rel</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"noopener noreferrer\"</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    ></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {children}</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">a</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"30\"></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> CustomInlineMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      inlineComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{customInlineComponents}</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport type { InlineComponents } from \"stream-mdx\";\n\nconst customInlineComponents: Partial<InlineComponents> = {\n  strong: ({ children }) => (\n    <strong className=\"font-bold text-primary\">{children}</strong>\n  ),\n\n  em: ({ children }) => (\n    <em className=\"italic text-muted-foreground\">{children}</em>\n  ),\n\n  code: ({ children }) => (\n    <code className=\"rounded bg-muted px-1.5 py-0.5 text-sm font-mono\">\n      {children}\n    </code>\n  ),\n\n  link: ({ href, children }) => (\n    <a\n      href={href}\n      className=\"text-blue-600 hover:underline\"\n      target=\"_blank\"\n      rel=\"noopener noreferrer\"\n    >\n      {children}\n    </a>\n  ),\n};\n\nexport function CustomInlineMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      inlineComponents={customInlineComponents}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "1afc0679",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "ShadCN Integration Example",
        "range": {
          "from": 15195,
          "to": 15225
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "ShadCN Integration Example",
          "headingId": "shadcn-integration-example"
        },
        "inline": [
          {
            "kind": "text",
            "text": "ShadCN Integration Example"
          }
        ]
      }
    },
    {
      "id": "13804f61",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\nconst shadcnComponents = {\n  table: ({ children, ...props }) => (\n    <div className=\"my-4 rounded-md border\">\n      <Table {...props}>{children}</Table>\n    </div>\n  ),\n  thead: TableHeader,\n  tbody: TableBody,\n  tr: TableRow,\n  th: TableHead,\n  td: TableCell,\n\n  blockquote: ({ children, ...props }) => (\n    <Card className=\"my-4 border-l-4 border-l-primary\">\n      <CardContent className=\"pt-6\">\n        {children}\n      </CardContent>\n    </Card>\n  ),\n};\n\nexport function ShadCNMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      components={shadcnComponents}\n    />\n  );\n}\n```",
        "range": {
          "from": 15227,
          "to": 16094
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@/components/ui/table\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { Card, CardContent, CardHeader, CardTitle } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"@/components/ui/card\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"4\"></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> shadcnComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  table</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"my-4 rounded-md border\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Table</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props}>{children}&#x3C;/</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Table</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  thead: TableHeader,</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  tbody: TableBody,</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  tr: TableRow,</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  th: TableHead,</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  td: TableCell,</span></span>\n<span class=\"line\" data-line=\"16\"></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  blockquote</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Card</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"my-4 border-l-4 border-l-primary\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">CardContent</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"pt-6\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        {children}</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">CardContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">Card</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"25\"></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ShadCNMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      components</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{shadcnComponents}</span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport { Table, TableBody, TableCell, TableHead, TableHeader, TableRow } from \"@/components/ui/table\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\nconst shadcnComponents = {\n  table: ({ children, ...props }) => (\n    <div className=\"my-4 rounded-md border\">\n      <Table {...props}>{children}</Table>\n    </div>\n  ),\n  thead: TableHeader,\n  tbody: TableBody,\n  tr: TableRow,\n  th: TableHead,\n  td: TableCell,\n\n  blockquote: ({ children, ...props }) => (\n    <Card className=\"my-4 border-l-4 border-l-primary\">\n      <CardContent className=\"pt-6\">\n        {children}\n      </CardContent>\n    </Card>\n  ),\n};\n\nexport function ShadCNMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      components={shadcnComponents}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "3ced872c",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 16096,
          "to": 16099
        }
      }
    },
    {
      "id": "3b06f5bd",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Custom Plugins",
        "range": {
          "from": 16101,
          "to": 16118
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Custom Plugins",
          "headingId": "custom-plugins"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Custom Plugins"
          }
        ]
      }
    },
    {
      "id": "10cac9d2",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "StreamMDX supports two layers of customization:",
        "range": {
          "from": 16120,
          "to": 16167
        },
        "inline": [
          {
            "kind": "text",
            "text": "StreamMDX supports two layers of customization:"
          }
        ]
      }
    },
    {
      "id": "61844725",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "1. **Rendering customization (React)**: use `components`, `inlineComponents`, `tableElements`, and `htmlElements`.\n2. **Syntax customization (Worker)**: adding new tokenizers/streaming matchers requires a custom worker bundle.",
        "range": {
          "from": 16169,
          "to": 16395
        },
        "meta": {
          "ordered": true,
          "items": [
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Rendering customization (React)"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": use "
              },
              {
                "kind": "code",
                "text": "components"
              },
              {
                "kind": "text",
                "text": ", "
              },
              {
                "kind": "code",
                "text": "inlineComponents"
              },
              {
                "kind": "text",
                "text": ", "
              },
              {
                "kind": "code",
                "text": "tableElements"
              },
              {
                "kind": "text",
                "text": ", and "
              },
              {
                "kind": "code",
                "text": "htmlElements"
              },
              {
                "kind": "text",
                "text": "."
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Syntax customization (Worker)"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": adding new tokenizers/streaming matchers requires a custom worker bundle."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "35ed3fb4",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "`<StreamingMarkdown />` does **not** accept an arbitrary plugin array prop. Built-in capabilities are toggled via `features`.",
        "range": {
          "from": 16397,
          "to": 16522
        },
        "inline": [
          {
            "kind": "code",
            "text": "<StreamingMarkdown />"
          },
          {
            "kind": "text",
            "text": " does "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "not"
              }
            ]
          },
          {
            "kind": "text",
            "text": " accept an arbitrary plugin array prop. Built-in capabilities are toggled via "
          },
          {
            "kind": "code",
            "text": "features"
          },
          {
            "kind": "text",
            "text": "."
          }
        ],
        "meta": {
          "mixedSegments": [
            {
              "kind": "text",
              "value": "`",
              "range": {
                "from": 16397,
                "to": 16398
              },
              "inline": [
                {
                  "kind": "text",
                  "text": "`"
                }
              ]
            },
            {
              "kind": "mdx",
              "value": "<StreamingMarkdown />",
              "range": {
                "from": 16398,
                "to": 16419
              },
              "status": "pending"
            },
            {
              "kind": "text",
              "value": "` does **not** accept an arbitrary plugin array prop. Built-in capabilities are toggled via `features`.",
              "range": {
                "from": 16419,
                "to": 16522
              },
              "inline": [
                {
                  "kind": "code",
                  "text": " does **not** accept an arbitrary plugin array prop. Built-in capabilities are toggled via "
                },
                {
                  "kind": "text",
                  "text": "features`."
                }
              ]
            }
          ]
        }
      }
    },
    {
      "id": "1e69aeda",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "If you need custom syntax (citations, mentions, domain-specific tags), the recommended path is:",
        "range": {
          "from": 16524,
          "to": 16619
        },
        "inline": [
          {
            "kind": "text",
            "text": "If you need custom syntax (citations, mentions, domain-specific tags), the recommended path is:"
          }
        ]
      }
    },
    {
      "id": "78558a7c",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Build a custom worker bundle that registers your plugins using `@stream-mdx/plugins/*`.\n- Host that worker (static asset) and pass its URL via the `worker` prop.\n- Render custom inline tokens via `inlineComponents` (once your worker emits them).",
        "range": {
          "from": 16621,
          "to": 16868
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Build a custom worker bundle that registers your plugins using "
              },
              {
                "kind": "code",
                "text": "@stream-mdx/plugins/*"
              },
              {
                "kind": "text",
                "text": "."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Host that worker (static asset) and pass its URL via the "
              },
              {
                "kind": "code",
                "text": "worker"
              },
              {
                "kind": "text",
                "text": " prop."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Render custom inline tokens via "
              },
              {
                "kind": "code",
                "text": "inlineComponents"
              },
              {
                "kind": "text",
                "text": " (once your worker emits them)."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "4327cdcc",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "Example inline renderer (React side):",
        "range": {
          "from": 16870,
          "to": 16907
        },
        "inline": [
          {
            "kind": "text",
            "text": "Example inline renderer (React side):"
          }
        ]
      }
    },
    {
      "id": "188a3337",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nconst inlineComponents = {\n  citation: ({ id }: { id: string }) => <sup>[{id}]</sup>,\n};\n\n<StreamingMarkdown text={text} inlineComponents={inlineComponents} />;\n```",
        "range": {
          "from": 16909,
          "to": 17080
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> inlineComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  citation</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">id</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">sup</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>[{id}]&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">sup</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>,</span></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"4\"></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">inlineComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{inlineComponents} />;</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "const inlineComponents = {\n  citation: ({ id }: { id: string }) => <sup>[{id}]</sup>,\n};\n\n<StreamingMarkdown text={text} inlineComponents={inlineComponents} />;"
        }
      }
    },
    {
      "id": "5c18d2ac",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "For end-to-end worker plugin wiring and registration order, see `docs/STREAMING_MARKDOWN_PLUGINS_COOKBOOK.md`.",
        "range": {
          "from": 17082,
          "to": 17192
        },
        "inline": [
          {
            "kind": "text",
            "text": "For end-to-end worker plugin wiring and registration order, see "
          },
          {
            "kind": "code",
            "text": "docs/STREAMING_MARKDOWN_PLUGINS_COOKBOOK.md"
          },
          {
            "kind": "text",
            "text": "."
          }
        ]
      }
    },
    {
      "id": "7387b24e",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 17194,
          "to": 17197
        }
      }
    },
    {
      "id": "7b710d3b",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "MDX Integration",
        "range": {
          "from": 17199,
          "to": 17217
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "MDX Integration",
          "headingId": "mdx-integration"
        },
        "inline": [
          {
            "kind": "text",
            "text": "MDX Integration"
          }
        ]
      }
    },
    {
      "id": "6e0a3704",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Basic MDX Setup",
        "range": {
          "from": 17219,
          "to": 17238
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Basic MDX Setup",
          "headingId": "basic-mdx-setup"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Basic MDX Setup"
          }
        ]
      }
    },
    {
      "id": "661c4874",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nconst mdxComponents = {\n  h1: (props: React.HTMLAttributes<HTMLHeadingElement>) => (\n    <h1 {...props} className=\"text-4xl font-bold mb-4\" />\n  ),\n  h2: (props: React.HTMLAttributes<HTMLHeadingElement>) => (\n    <h2 {...props} className=\"text-3xl font-semibold mb-3\" />\n  ),\n  p: (props: React.HTMLAttributes<HTMLParagraphElement>) => (\n    <p {...props} className=\"mb-3 leading-relaxed\" />\n  ),\n  YouTube: ({ id }: { id: string }) => (\n    <iframe\n      width=\"560\"\n      height=\"315\"\n      src={`https://www.youtube.com/embed/${id}`}\n      frameBorder=\"0\"\n      allowFullScreen\n    />\n  ),\n  Callout: ({ type, children }: { type: \"info\" | \"warn\"; children: React.ReactNode }) => (\n    <div className={`border-l-4 p-4 my-4 ${\n      type === \"warn\" ? \"border-yellow-500 bg-yellow-50\" : \"border-blue-500 bg-blue-50\"\n    }`}>\n      {children}\n    </div>\n  ),\n};\n\nexport function MDXMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      worker=\"/workers/markdown-worker.js\"\n      features={{ mdx: true, math: true, tables: true, html: true }}\n      mdxCompileMode=\"worker\"\n      mdxComponents={mdxComponents}\n    />\n  );\n}\n```",
        "range": {
          "from": 17240,
          "to": 18463
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> mdxComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  h1</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: (</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> React</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLAttributes</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLHeadingElement</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">h1</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"text-4xl font-bold mb-4\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> /></span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  h2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: (</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> React</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLAttributes</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLHeadingElement</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">h2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"text-3xl font-semibold mb-3\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> /></span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  p</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: (</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">props</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> React</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLAttributes</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">HTMLParagraphElement</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">p</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">props} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"mb-3 leading-relaxed\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> /></span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  YouTube</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">id</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">iframe</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      width</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"560\"</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      height</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"315\"</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      src</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`https://www.youtube.com/embed/${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">id</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      frameBorder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"0\"</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      allowFullScreen</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  Callout</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">type</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"info\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"warn\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">; </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">children</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> React</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">ReactNode</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`border-l-4 p-4 my-4 ${</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      type</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> ===</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"warn\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> ?</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"border-yellow-500 bg-yellow-50\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> :</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"border-blue-500 bg-blue-50\"</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    }`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {children}</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ),</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"30\"></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> MDXMarkdown</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      worker</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/workers/markdown-worker.js\"</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      features</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, math: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, tables: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, html: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      mdxCompileMode</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"worker\"</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      mdxComponents</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{mdxComponents}</span></span>\n<span class=\"line\" data-line=\"39\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"41\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nconst mdxComponents = {\n  h1: (props: React.HTMLAttributes<HTMLHeadingElement>) => (\n    <h1 {...props} className=\"text-4xl font-bold mb-4\" />\n  ),\n  h2: (props: React.HTMLAttributes<HTMLHeadingElement>) => (\n    <h2 {...props} className=\"text-3xl font-semibold mb-3\" />\n  ),\n  p: (props: React.HTMLAttributes<HTMLParagraphElement>) => (\n    <p {...props} className=\"mb-3 leading-relaxed\" />\n  ),\n  YouTube: ({ id }: { id: string }) => (\n    <iframe\n      width=\"560\"\n      height=\"315\"\n      src={`https://www.youtube.com/embed/${id}`}\n      frameBorder=\"0\"\n      allowFullScreen\n    />\n  ),\n  Callout: ({ type, children }: { type: \"info\" | \"warn\"; children: React.ReactNode }) => (\n    <div className={`border-l-4 p-4 my-4 ${\n      type === \"warn\" ? \"border-yellow-500 bg-yellow-50\" : \"border-blue-500 bg-blue-50\"\n    }`}>\n      {children}\n    </div>\n  ),\n};\n\nexport function MDXMarkdown({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      worker=\"/workers/markdown-worker.js\"\n      features={{ mdx: true, math: true, tables: true, html: true }}\n      mdxCompileMode=\"worker\"\n      mdxComponents={mdxComponents}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "13e2bb7c",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Server vs Worker MDX ‚Äî Parity and Strategy",
        "range": {
          "from": 18465,
          "to": 18511
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Server vs Worker MDX ‚Äî Parity and Strategy",
          "headingId": "server-vs-worker-mdx-parity-and-strategy"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Server vs Worker MDX ‚Äî Parity and Strategy"
          }
        ]
      }
    },
    {
      "id": "458ee9f8",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "StreamMDX supports two MDX compilation strategies:",
        "range": {
          "from": 18513,
          "to": 18563
        },
        "inline": [
          {
            "kind": "text",
            "text": "StreamMDX supports two MDX compilation strategies:"
          }
        ]
      }
    },
    {
      "id": "22be7627",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- `mdxCompileMode=\"server\"` ‚Äì MDX blocks are compiled via the `/api/mdx-compile-v2` endpoint.\n- `mdxCompileMode=\"worker\"` ‚Äì MDX is compiled inside the worker bundle itself.",
        "range": {
          "from": 18565,
          "to": 18737
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "code",
                "text": "mdxCompileMode=\"server\""
              },
              {
                "kind": "text",
                "text": " ‚Äì MDX blocks are compiled via the "
              },
              {
                "kind": "code",
                "text": "/api/mdx-compile-v2"
              },
              {
                "kind": "text",
                "text": " endpoint."
              }
            ],
            [
              {
                "kind": "code",
                "text": "mdxCompileMode=\"worker\""
              },
              {
                "kind": "text",
                "text": " ‚Äì MDX is compiled inside the worker bundle itself."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "50ab8dc2",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "Both strategies can share the **same MDX compilation pipeline** when you use the exported helper:",
        "range": {
          "from": 18739,
          "to": 18836
        },
        "inline": [
          {
            "kind": "text",
            "text": "Both strategies can share the "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "same MDX compilation pipeline"
              }
            ]
          },
          {
            "kind": "text",
            "text": " when you use the exported helper:"
          }
        ]
      }
    },
    {
      "id": "3f322b22",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- `remark-gfm` and `remark-math` for markdown + math parsing.\n- `rehype-slug` and `rehype-katex` for headings and math HTML.\n- `@mdx-js/mdx` with `outputFormat: \"function-body\"` and the React JSX runtime.",
        "range": {
          "from": 18838,
          "to": 19042
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "code",
                "text": "remark-gfm"
              },
              {
                "kind": "text",
                "text": " and "
              },
              {
                "kind": "code",
                "text": "remark-math"
              },
              {
                "kind": "text",
                "text": " for markdown + math parsing."
              }
            ],
            [
              {
                "kind": "code",
                "text": "rehype-slug"
              },
              {
                "kind": "text",
                "text": " and "
              },
              {
                "kind": "code",
                "text": "rehype-katex"
              },
              {
                "kind": "text",
                "text": " for headings and math HTML."
              }
            ],
            [
              {
                "kind": "code",
                "text": "@mdx-js/mdx"
              },
              {
                "kind": "text",
                "text": " with "
              },
              {
                "kind": "code",
                "text": "outputFormat: \"function-body\""
              },
              {
                "kind": "text",
                "text": " and the React JSX runtime."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "2ad735f0",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "The worker compilation path uses the same pipeline; for server compilation, use `compileMdxContent` from `stream-mdx/worker/mdx-compile` (or `@stream-mdx/worker/mdx-compile`) to keep parity.",
        "range": {
          "from": 19044,
          "to": 19234
        },
        "inline": [
          {
            "kind": "text",
            "text": "The worker compilation path uses the same pipeline; for server compilation, use "
          },
          {
            "kind": "code",
            "text": "compileMdxContent"
          },
          {
            "kind": "text",
            "text": " from "
          },
          {
            "kind": "code",
            "text": "stream-mdx/worker/mdx-compile"
          },
          {
            "kind": "text",
            "text": " (or "
          },
          {
            "kind": "code",
            "text": "@stream-mdx/worker/mdx-compile"
          },
          {
            "kind": "text",
            "text": ") to keep parity."
          }
        ]
      }
    },
    {
      "id": "29f50315",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "For strict CSP or centralized caching, prefer **server** mode. For lower latency or offline scenarios, prefer **worker** mode. In either case, you can assume **matching HTML/DOM output and hydration behavior** for the same MDX source and `components` map.",
        "range": {
          "from": 19236,
          "to": 19491
        },
        "inline": [
          {
            "kind": "text",
            "text": "For strict CSP or centralized caching, prefer "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "server"
              }
            ]
          },
          {
            "kind": "text",
            "text": " mode. For lower latency or offline scenarios, prefer "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "worker"
              }
            ]
          },
          {
            "kind": "text",
            "text": " mode. In either case, you can assume "
          },
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "matching HTML/DOM output and hydration behavior"
              }
            ]
          },
          {
            "kind": "text",
            "text": " for the same MDX source and "
          },
          {
            "kind": "code",
            "text": "components"
          },
          {
            "kind": "text",
            "text": " map."
          }
        ]
      }
    },
    {
      "id": "301829ca",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "MDX with Server Compilation",
        "range": {
          "from": 19493,
          "to": 19524
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "MDX with Server Compilation",
          "headingId": "mdx-with-server-compilation"
        },
        "inline": [
          {
            "kind": "text",
            "text": "MDX with Server Compilation"
          }
        ]
      }
    },
    {
      "id": "657f469d",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function ServerMDX({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      features={{ mdx: true }}\n      mdxCompileMode=\"server\" // Uses /api/mdx-compile-v2 endpoint\n    />\n  );\n}\n```",
        "range": {
          "from": 19526,
          "to": 19805
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ServerMDX</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      features</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      mdxCompileMode</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"server\"</span><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\"> // Uses /api/mdx-compile-v2 endpoint</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nexport function ServerMDX({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      features={{ mdx: true }}\n      mdxCompileMode=\"server\" // Uses /api/mdx-compile-v2 endpoint\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "3ed6ecbf",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**API Route (`app/api/mdx-compile-v2/route.ts`):**",
        "range": {
          "from": 19807,
          "to": 19857
        },
        "inline": [
          {
            "kind": "text",
            "text": "**API Route ("
          },
          {
            "kind": "code",
            "text": "app/api/mdx-compile-v2/route.ts"
          },
          {
            "kind": "text",
            "text": "):**"
          }
        ]
      }
    },
    {
      "id": "75f57ba0",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```ts\nimport { NextRequest, NextResponse } from \"next/server\";\nimport { compileMdxContent } from \"stream-mdx/worker/mdx-compile\";\n\nexport async function POST(request: NextRequest) {\n  const { content, blockId } = await request.json();\n  \n  try {\n    const compiled = await compileMdxContent(content);\n\n    return NextResponse.json({\n      // `blockId` comes from the client and is used for caching.\n      id: blockId,\n      code: compiled.code,\n      dependencies: compiled.dependencies,\n    });\n  } catch (error) {\n    return NextResponse.json(\n      { error: \"MDX compilation failed\" },\n      { status: 500 }\n    );\n  }\n}\n```",
        "range": {
          "from": 19859,
          "to": 20486
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"typescript\"><code data-language=\"typescript\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { NextRequest, NextResponse } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"next/server\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { compileMdxContent } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx/worker/mdx-compile\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> POST</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">request</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> NextRequest</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">content</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">blockId</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> request.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">json</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  </span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  try</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> compiled</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> compileMdxContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(content);</span></span>\n<span class=\"line\" data-line=\"9\"></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> NextResponse.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">json</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">      // `blockId` comes from the client and is used for caching.</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      id: blockId,</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      code: compiled.code,</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      dependencies: compiled.dependencies,</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    });</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">catch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (error) {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> NextResponse.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">json</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      { error: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"MDX compilation failed\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      { status: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">500</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    );</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "typescript",
          "code": "import { NextRequest, NextResponse } from \"next/server\";\nimport { compileMdxContent } from \"stream-mdx/worker/mdx-compile\";\n\nexport async function POST(request: NextRequest) {\n  const { content, blockId } = await request.json();\n  \n  try {\n    const compiled = await compileMdxContent(content);\n\n    return NextResponse.json({\n      // `blockId` comes from the client and is used for caching.\n      id: blockId,\n      code: compiled.code,\n      dependencies: compiled.dependencies,\n    });\n  } catch (error) {\n    return NextResponse.json(\n      { error: \"MDX compilation failed\" },\n      { status: 500 }\n    );\n  }\n}"
        }
      }
    },
    {
      "id": "6a38c646",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Feature Flags: Math, HTML, MDX, Format Anticipation",
        "range": {
          "from": 20488,
          "to": 20543
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Feature Flags: Math, HTML, MDX, Format Anticipation",
          "headingId": "feature-flags-math-html-mdx-format-anticipation"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Feature Flags: Math, HTML, MDX, Format Anticipation"
          }
        ]
      }
    },
    {
      "id": "2ea5a320",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "The `features` prop on `<StreamingMarkdown />` controls built‚Äëin domains:",
        "range": {
          "from": 20545,
          "to": 20618
        },
        "inline": [
          {
            "kind": "text",
            "text": "The "
          },
          {
            "kind": "code",
            "text": "features"
          },
          {
            "kind": "text",
            "text": " prop on "
          },
          {
            "kind": "code",
            "text": "<StreamingMarkdown />"
          },
          {
            "kind": "text",
            "text": " controls built‚Äëin domains:"
          }
        ],
        "meta": {
          "mixedSegments": [
            {
              "kind": "text",
              "value": "The `features` prop on `",
              "range": {
                "from": 20545,
                "to": 20569
              },
              "inline": [
                {
                  "kind": "text",
                  "text": "The "
                },
                {
                  "kind": "code",
                  "text": "features"
                },
                {
                  "kind": "text",
                  "text": " prop on `"
                }
              ]
            },
            {
              "kind": "mdx",
              "value": "<StreamingMarkdown />",
              "range": {
                "from": 20569,
                "to": 20590
              },
              "status": "pending"
            },
            {
              "kind": "text",
              "value": "` controls built‚Äëin domains:",
              "range": {
                "from": 20590,
                "to": 20618
              },
              "inline": [
                {
                  "kind": "text",
                  "text": "` controls built‚Äëin domains:"
                }
              ]
            }
          ]
        }
      }
    },
    {
      "id": "49f9a362",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\n<StreamingMarkdown\n  text={text}\n  features={{\n    math: true,\n    mdx: true,\n    html: true,\n    tables: true,\n    callouts: true,\n    footnotes: true,\n    formatAnticipation: false,\n    codeHighlighting: \"incremental\",\n  }}\n/>\n```",
        "range": {
          "from": 20620,
          "to": 20859
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  features</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    math: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    html: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    tables: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    callouts: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    footnotes: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    formatAnticipation: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">false</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    codeHighlighting: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"incremental\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }}</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">/></span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "<StreamingMarkdown\n  text={text}\n  features={{\n    math: true,\n    mdx: true,\n    html: true,\n    tables: true,\n    callouts: true,\n    footnotes: true,\n    formatAnticipation: false,\n    codeHighlighting: \"incremental\",\n  }}\n/>"
        }
      }
    },
    {
      "id": "5a4b6ca1",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Set `math: false` to disable math detection/rendering and treat math as plain text.\n- Set `mdx: false` to skip MDX detection/compilation and render MDX markup as regular markdown/text.\n- Set `html: false` to avoid inline/block HTML plugins beyond the core sanitization path.\n- Set `formatAnticipation: true` to withhold formatting markers while streaming (initial support: `*`, `**`, `` ` ``, `~~`).\n- Set `codeHighlighting: \"final\" | \"incremental\" | \"live\"` to control Shiki behavior:\n  - `\"final\"` (default): highlight only after a code block finalizes.\n  - `\"incremental\"`: highlight completed lines as they arrive.\n  - `\"live\"`: re-highlight on every update (slowest, highest fidelity).",
        "range": {
          "from": 20861,
          "to": 21553
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "math: false"
              },
              {
                "kind": "text",
                "text": " to disable math detection/rendering and treat math as plain text."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "mdx: false"
              },
              {
                "kind": "text",
                "text": " to skip MDX detection/compilation and render MDX markup as regular markdown/text."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "html: false"
              },
              {
                "kind": "text",
                "text": " to avoid inline/block HTML plugins beyond the core sanitization path."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "formatAnticipation: true"
              },
              {
                "kind": "text",
                "text": " to withhold formatting markers while streaming (initial support: "
              },
              {
                "kind": "code",
                "text": "*"
              },
              {
                "kind": "text",
                "text": ", "
              },
              {
                "kind": "code",
                "text": "**"
              },
              {
                "kind": "text",
                "text": ", `"
              },
              {
                "kind": "code",
                "text": " "
              },
              {
                "kind": "text",
                "text": " `"
              },
              {
                "kind": "code",
                "text": ", "
              },
              {
                "kind": "text",
                "text": "~~`)."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "codeHighlighting: \"final\" | \"incremental\" | \"live\""
              },
              {
                "kind": "text",
                "text": " to control Shiki behavior:"
              }
            ],
            [
              {
                "kind": "code",
                "text": "\"final\""
              },
              {
                "kind": "text",
                "text": " (default): highlight only after a code block finalizes."
              }
            ],
            [
              {
                "kind": "code",
                "text": "\"incremental\""
              },
              {
                "kind": "text",
                "text": ": highlight completed lines as they arrive."
              }
            ],
            [
              {
                "kind": "code",
                "text": "\"live\""
              },
              {
                "kind": "text",
                "text": ": re-highlight on every update (slowest, highest fidelity)."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "45163422",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "Under the hood these flags drive worker doc plugins and React bindings for those domains without you having to touch internal APIs.",
        "range": {
          "from": 21555,
          "to": 21686
        },
        "inline": [
          {
            "kind": "text",
            "text": "Under the hood these flags drive worker doc plugins and React bindings for those domains without you having to touch internal APIs."
          }
        ]
      }
    },
    {
      "id": "644c2ed9",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Math Delimiters (Markdown vs MDX)",
        "range": {
          "from": 21688,
          "to": 21725
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Math Delimiters (Markdown vs MDX)",
          "headingId": "math-delimiters-markdown-vs-mdx"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Math Delimiters (Markdown vs MDX)"
          }
        ]
      }
    },
    {
      "id": "555bb1bb",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "By default:",
        "range": {
          "from": 21727,
          "to": 21738
        },
        "inline": [
          {
            "kind": "text",
            "text": "By default:"
          }
        ]
      }
    },
    {
      "id": "66968660",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Streaming math treats `$‚Ä¶$` as inline math and `$$‚Ä¶$$` as display/block math.\n- The MDX pipeline uses `remark-math`, which understands both `$`/`$$` and `\\\\(‚Ä¶\\\\)` / `\\\\[‚Ä¶\\\\]` syntaxes.",
        "range": {
          "from": 21740,
          "to": 21926
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Streaming math treats `"
              },
              {
                "kind": "math-inline",
                "tex": "‚Ä¶"
              },
              {
                "kind": "code",
                "text": " as inline math and "
              },
              {
                "kind": "math-display",
                "tex": "‚Ä¶"
              },
              {
                "kind": "text",
                "text": "` as display/block math."
              }
            ],
            [
              {
                "kind": "text",
                "text": "The MDX pipeline uses "
              },
              {
                "kind": "code",
                "text": "remark-math"
              },
              {
                "kind": "text",
                "text": ", which understands both `"
              },
              {
                "kind": "math-inline",
                "tex": "`/`"
              },
              {
                "kind": "text",
                "text": "$"
              },
              {
                "kind": "code",
                "text": " and "
              },
              {
                "kind": "text",
                "text": "\\"
              },
              {
                "kind": "text",
                "text": "(‚Ä¶"
              },
              {
                "kind": "text",
                "text": "\\"
              },
              {
                "kind": "text",
                "text": ")"
              },
              {
                "kind": "code",
                "text": " / "
              },
              {
                "kind": "text",
                "text": "\\"
              },
              {
                "kind": "text",
                "text": "[‚Ä¶"
              },
              {
                "kind": "text",
                "text": "\\"
              },
              {
                "kind": "text",
                "text": "]` syntaxes."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "1c8f0e08",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "If you need a different policy (for example, only `\\\\(‚Ä¶\\\\)` and `\\\\[‚Ä¶\\\\]` as used in ChatGPT‚Äôs renderer):",
        "range": {
          "from": 21928,
          "to": 22033
        },
        "inline": [
          {
            "kind": "text",
            "text": "If you need a different policy (for example, only `"
          },
          {
            "kind": "text",
            "text": "\\"
          },
          {
            "kind": "text",
            "text": "(‚Ä¶"
          },
          {
            "kind": "text",
            "text": "\\"
          },
          {
            "kind": "text",
            "text": ")"
          },
          {
            "kind": "code",
            "text": " and "
          },
          {
            "kind": "text",
            "text": "\\"
          },
          {
            "kind": "text",
            "text": "[‚Ä¶"
          },
          {
            "kind": "text",
            "text": "\\"
          },
          {
            "kind": "text",
            "text": "]` as used in ChatGPT‚Äôs renderer):"
          }
        ]
      }
    },
    {
      "id": "8ab44de",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- For **MDX**, you would adjust the `remark-math` options (e.g., `singleDollarTextMath: false`) in a fork or custom integration.\n- For **streaming Markdown**, you would customize the worker bundle to use different patterns/tokenizers.",
        "range": {
          "from": 22035,
          "to": 22269
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "For "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "MDX"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ", you would adjust the "
              },
              {
                "kind": "code",
                "text": "remark-math"
              },
              {
                "kind": "text",
                "text": " options (e.g., "
              },
              {
                "kind": "code",
                "text": "singleDollarTextMath: false"
              },
              {
                "kind": "text",
                "text": ") in a fork or custom integration."
              }
            ],
            [
              {
                "kind": "text",
                "text": "For "
              },
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "streaming Markdown"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ", you would customize the worker bundle to use different patterns/tokenizers."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "72f0fe4c",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "These are plugin‚Äëlevel customizations rather than runtime props, but the pipeline is modular enough to support them when needed.",
        "range": {
          "from": 22271,
          "to": 22399
        },
        "inline": [
          {
            "kind": "text",
            "text": "These are plugin‚Äëlevel customizations rather than runtime props, but the pipeline is modular enough to support them when needed."
          }
        ]
      }
    },
    {
      "id": "2877efe1",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 22401,
          "to": 22404
        }
      }
    },
    {
      "id": "513855f6",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Performance Optimization",
        "range": {
          "from": 22406,
          "to": 22433
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Performance Optimization",
          "headingId": "performance-optimization"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Performance Optimization"
          }
        ]
      }
    },
    {
      "id": "8a0719a",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "1. Prewarm Languages",
        "range": {
          "from": 22435,
          "to": 22459
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "1. Prewarm Languages",
          "headingId": "1-prewarm-languages"
        },
        "inline": [
          {
            "kind": "text",
            "text": "1. Prewarm Languages"
          }
        ]
      }
    },
    {
      "id": "1be5597b",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\n<StreamingMarkdown\n  text={content}\n  prewarmLangs={[\n    \"typescript\",\n    \"tsx\",\n    \"javascript\",\n    \"bash\",\n    \"markdown\",\n    \"json\",\n    \"yaml\",\n  ]}\n/>\n```",
        "range": {
          "from": 22461,
          "to": 22632
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"tsx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"javascript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"markdown\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"json\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">    \"yaml\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  ]}</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">/></span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "<StreamingMarkdown\n  text={content}\n  prewarmLangs={[\n    \"typescript\",\n    \"tsx\",\n    \"javascript\",\n    \"bash\",\n    \"markdown\",\n    \"json\",\n    \"yaml\",\n  ]}\n/>"
        }
      }
    },
    {
      "id": "731b7b19",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "2. Monitor Performance",
        "range": {
          "from": 22634,
          "to": 22660
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "2. Monitor Performance",
          "headingId": "2-monitor-performance"
        },
        "inline": [
          {
            "kind": "text",
            "text": "2. Monitor Performance"
          }
        ]
      }
    },
    {
      "id": "4a6e271e",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport type { RendererMetrics } from \"stream-mdx\";\n\nfunction onMetrics(metrics: RendererMetrics) {\n  // Log performance data\n  console.log(\"Queue depth:\", metrics.queueDepthBefore);\n  console.log(\"Flush duration:\", metrics.durationMs);\n  \n  // Alert if performance degrades\n  if (metrics.durationMs > 16) {\n    console.warn(\"Frame budget exceeded!\");\n  }\n  \n  // Send to analytics\n  if (window.analytics) {\n    window.analytics.track(\"markdown_flush\", {\n      duration: metrics.durationMs,\n      queueDepth: metrics.queueDepthBefore,\n    });\n  }\n}\n\n<StreamingMarkdown\n  text={content}\n  onMetrics={onMetrics}\n/>\n```",
        "range": {
          "from": 22662,
          "to": 23332
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { RendererMetrics } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onMetrics</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">metrics</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> RendererMetrics</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">  // Log performance data</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  console.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">log</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Queue depth:\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, metrics.queueDepthBefore);</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  console.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">log</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Flush duration:\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, metrics.durationMs);</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  </span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">  // Alert if performance degrades</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (metrics.durationMs </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">></span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 16</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    console.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">warn</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Frame budget exceeded!\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  </span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">  // Send to analytics</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (window.analytics) {</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    window.analytics.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">track</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"markdown_flush\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      duration: metrics.durationMs,</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      queueDepth: metrics.queueDepthBefore,</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    });</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"22\"></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  onMetrics</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{onMetrics}</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">/></span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport type { RendererMetrics } from \"stream-mdx\";\n\nfunction onMetrics(metrics: RendererMetrics) {\n  // Log performance data\n  console.log(\"Queue depth:\", metrics.queueDepthBefore);\n  console.log(\"Flush duration:\", metrics.durationMs);\n  \n  // Alert if performance degrades\n  if (metrics.durationMs > 16) {\n    console.warn(\"Frame budget exceeded!\");\n  }\n  \n  // Send to analytics\n  if (window.analytics) {\n    window.analytics.track(\"markdown_flush\", {\n      duration: metrics.durationMs,\n      queueDepth: metrics.queueDepthBefore,\n    });\n  }\n}\n\n<StreamingMarkdown\n  text={content}\n  onMetrics={onMetrics}\n/>"
        }
      }
    },
    {
      "id": "2a17edfd",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "3. Adjust Scheduling",
        "range": {
          "from": 23334,
          "to": 23358
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "3. Adjust Scheduling",
          "headingId": "3-adjust-scheduling"
        },
        "inline": [
          {
            "kind": "text",
            "text": "3. Adjust Scheduling"
          }
        ]
      }
    },
    {
      "id": "ec91008",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\n<StreamingMarkdown\n  text={content}\n  scheduling={{\n    batch: \"microtask\", // Lowest latency; falls back when unavailable\n    frameBudgetMs: 10, // Smaller = more responsive, slower completion\n    lowPriorityFrameBudgetMs: 6,\n    maxBatchesPerFlush: 12,\n    maxLowPriorityBatchesPerFlush: 2,\n    urgentQueueThreshold: 4,\n    adaptiveSwitch: false, // Disable auto-switching to smooth scheduling\n    historyLimit: 200, // Keep patch history manageable\n  }}\n/>\n```",
        "range": {
          "from": 23360,
          "to": 23830
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  scheduling</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    batch: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"microtask\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">// Lowest latency; falls back when unavailable</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    frameBudgetMs: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">10</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">// Smaller = more responsive, slower completion</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    lowPriorityFrameBudgetMs: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">6</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    maxBatchesPerFlush: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">12</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    maxLowPriorityBatchesPerFlush: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    urgentQueueThreshold: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">4</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    adaptiveSwitch: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">false</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">// Disable auto-switching to smooth scheduling</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    historyLimit: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">200</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">// Keep patch history manageable</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }}</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">/></span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "<StreamingMarkdown\n  text={content}\n  scheduling={{\n    batch: \"microtask\", // Lowest latency; falls back when unavailable\n    frameBudgetMs: 10, // Smaller = more responsive, slower completion\n    lowPriorityFrameBudgetMs: 6,\n    maxBatchesPerFlush: 12,\n    maxLowPriorityBatchesPerFlush: 2,\n    urgentQueueThreshold: 4,\n    adaptiveSwitch: false, // Disable auto-switching to smooth scheduling\n    historyLimit: 200, // Keep patch history manageable\n  }}\n/>"
        }
      }
    },
    {
      "id": "6a294e3a",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "4. Use Imperative Handle for Control",
        "range": {
          "from": 23832,
          "to": 23872
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "4. Use Imperative Handle for Control",
          "headingId": "4-use-imperative-handle-for-control"
        },
        "inline": [
          {
            "kind": "text",
            "text": "4. Use Imperative Handle for Control"
          }
        ]
      }
    },
    {
      "id": "51e88e20",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useRef } from \"react\";\nimport { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\n\nexport function ControlledStreaming({ stream }: { stream: AsyncIterable<string> }) {\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n\n  function pause() {\n    handleRef.current?.pause();\n  }\n\n  function resume() {\n    handleRef.current?.resume();\n  }\n\n  async function waitForCompletion() {\n    await handleRef.current?.waitForIdle();\n    console.log(\"Streaming complete!\");\n  }\n\n  return (\n    <div>\n      <div className=\"controls\">\n        <button onClick={pause}>Pause</button>\n        <button onClick={resume}>Resume</button>\n        <button onClick={waitForCompletion}>Wait for Completion</button>\n      </div>\n      <StreamingMarkdown\n        ref={handleRef}\n        stream={stream}\n      />\n    </div>\n  );\n}\n```",
        "range": {
          "from": 23874,
          "to": 24722
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useRef } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> StreamingMarkdownHandle } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ControlledStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> AsyncIterable</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> handleRef</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useRef</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">StreamingMarkdownHandle</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> pause</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    handleRef.current?.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">pause</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"10\"></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> resume</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    handleRef.current?.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">resume</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"14\"></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> waitForCompletion</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> handleRef.current?.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">waitForIdle</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    console.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">log</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Streaming complete!\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"19\"></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"controls\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{pause}>Pause&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{resume}>Resume&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{waitForCompletion}>Wait for Completion&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        ref</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{handleRef}</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{stream}</span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      /></span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useRef } from \"react\";\nimport { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\n\nexport function ControlledStreaming({ stream }: { stream: AsyncIterable<string> }) {\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n\n  function pause() {\n    handleRef.current?.pause();\n  }\n\n  function resume() {\n    handleRef.current?.resume();\n  }\n\n  async function waitForCompletion() {\n    await handleRef.current?.waitForIdle();\n    console.log(\"Streaming complete!\");\n  }\n\n  return (\n    <div>\n      <div className=\"controls\">\n        <button onClick={pause}>Pause</button>\n        <button onClick={resume}>Resume</button>\n        <button onClick={waitForCompletion}>Wait for Completion</button>\n      </div>\n      <StreamingMarkdown\n        ref={handleRef}\n        stream={stream}\n      />\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "46909c9d",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 24724,
          "to": 24727
        }
      }
    },
    {
      "id": "22393c4c",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Common Patterns",
        "range": {
          "from": 24729,
          "to": 24747
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Common Patterns",
          "headingId": "common-patterns"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Common Patterns"
          }
        ]
      }
    },
    {
      "id": "acc1e8a",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 0: Streaming polish (caret + link safety + deferred blocks)",
        "range": {
          "from": 24749,
          "to": 24820
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 0: Streaming polish (caret + link safety + deferred blocks)",
          "headingId": "pattern-0-streaming-polish-caret-link-safety-deferred-blocks"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 0: Streaming polish (caret + link safety + deferred blocks)"
          }
        ]
      }
    },
    {
      "id": "25bbdc62",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function StreamingMessage({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      caret=\"block\"\n      linkSafety={{ enabled: true }}\n      deferHeavyBlocks={{ rootMargin: \"200px 0px\" }}\n    />\n  );\n}\n```",
        "range": {
          "from": 24822,
          "to": 25120
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"></span>\n<span class=\"line\" data-line=\"3\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> StreamingMessage</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{text}</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      caret</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"block\"</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      linkSafety</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ enabled: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      deferHeavyBlocks</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ rootMargin: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"200px 0px\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    /></span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\n\nexport function StreamingMessage({ text }: { text: string }) {\n  return (\n    <StreamingMarkdown\n      text={text}\n      caret=\"block\"\n      linkSafety={{ enabled: true }}\n      deferHeavyBlocks={{ rootMargin: \"200px 0px\" }}\n    />\n  );\n}"
        }
      }
    },
    {
      "id": "615057e2",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 1: Chat Interface with Message History",
        "range": {
          "from": 25122,
          "to": 25172
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 1: Chat Interface with Message History",
          "headingId": "pattern-1-chat-interface-with-message-history"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 1: Chat Interface with Message History"
          }
        ]
      }
    },
    {
      "id": "5cb6cdf7",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  timestamp: Date;\n}\n\nexport function ChatInterface() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [currentAssistant, setCurrentAssistant] = useState<string>(\"\");\n\n  async function handleSend(userMessage: string) {\n    // Add user message\n    setMessages(prev => [...prev, {\n      id: `user-${Date.now()}`,\n      role: \"user\",\n      content: userMessage,\n      timestamp: new Date(),\n    }]);\n\n    // Stream assistant response\n    setCurrentAssistant(\"\");\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: userMessage }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let content = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n      content += decoder.decode(value, { stream: true });\n      setCurrentAssistant(content);\n    }\n\n    // Finalize\n    setMessages(prev => [...prev, {\n      id: `assistant-${Date.now()}`,\n      role: \"assistant\",\n      content,\n      timestamp: new Date(),\n    }]);\n    setCurrentAssistant(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      {messages.map(msg => (\n        <div key={msg.id} className={`message ${msg.role}`}>\n          <StreamingMarkdown text={msg.content} />\n        </div>\n      ))}\n      {currentAssistant && (\n        <div className=\"message assistant streaming\">\n          <StreamingMarkdown text={currentAssistant} />\n        </div>\n      )}\n    </div>\n  );\n}\n```",
        "range": {
          "from": 25174,
          "to": 26862
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">interface</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Message</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  role</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"user\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"assistant\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  content</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">  timestamp</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Date</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span>\n<span class=\"line\" data-line=\"10\"></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> ChatInterface</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">messages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">Message</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">[]>([]);</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">currentAssistant</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setCurrentAssistant</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"14\"></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> handleSend</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">userMessage</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Add user message</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, {</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      id: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`user-${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">Date</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">now</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">()</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"user\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content: userMessage,</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      timestamp: </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Date</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(),</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }]);</span></span>\n<span class=\"line\" data-line=\"23\"></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Stream assistant response</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setCurrentAssistant</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> response</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> fetch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/api/chat\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, {</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      method: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"POST\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      body: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">JSON</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">stringify</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ message: userMessage }),</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    });</span></span>\n<span class=\"line\" data-line=\"30\"></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> reader</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> response.body</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">getReader</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> decoder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> TextDecoder</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    let</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> content </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"34\"></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    while</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">done</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">value</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> reader.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">read</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (done) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">break</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> decoder.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">decode</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(value, { stream: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> });</span></span>\n<span class=\"line\" data-line=\"39\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      setCurrentAssistant</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(content);</span></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }</span></span>\n<span class=\"line\" data-line=\"41\"></span>\n<span class=\"line\" data-line=\"42\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Finalize</span></span>\n<span class=\"line\" data-line=\"43\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, {</span></span>\n<span class=\"line\" data-line=\"44\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      id: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`assistant-${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">Date</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">now</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">()</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"45\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"assistant\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"46\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content,</span></span>\n<span class=\"line\" data-line=\"47\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      timestamp: </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Date</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(),</span></span>\n<span class=\"line\" data-line=\"48\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }]);</span></span>\n<span class=\"line\" data-line=\"49\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setCurrentAssistant</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"50\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"51\"></span>\n<span class=\"line\" data-line=\"52\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"53\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"chat-container\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"54\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {messages.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">map</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">msg</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"55\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> key</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{msg.id} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`message ${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">msg</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">role</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}></span></span>\n<span class=\"line\" data-line=\"56\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{msg.content} /></span></span>\n<span class=\"line\" data-line=\"57\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"58\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      ))}</span></span>\n<span class=\"line\" data-line=\"59\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {currentAssistant </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"60\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"message assistant streaming\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"61\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{currentAssistant} /></span></span>\n<span class=\"line\" data-line=\"62\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"63\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      )}</span></span>\n<span class=\"line\" data-line=\"64\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"65\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"66\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\ninterface Message {\n  id: string;\n  role: \"user\" | \"assistant\";\n  content: string;\n  timestamp: Date;\n}\n\nexport function ChatInterface() {\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [currentAssistant, setCurrentAssistant] = useState<string>(\"\");\n\n  async function handleSend(userMessage: string) {\n    // Add user message\n    setMessages(prev => [...prev, {\n      id: `user-${Date.now()}`,\n      role: \"user\",\n      content: userMessage,\n      timestamp: new Date(),\n    }]);\n\n    // Stream assistant response\n    setCurrentAssistant(\"\");\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: userMessage }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let content = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n      content += decoder.decode(value, { stream: true });\n      setCurrentAssistant(content);\n    }\n\n    // Finalize\n    setMessages(prev => [...prev, {\n      id: `assistant-${Date.now()}`,\n      role: \"assistant\",\n      content,\n      timestamp: new Date(),\n    }]);\n    setCurrentAssistant(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      {messages.map(msg => (\n        <div key={msg.id} className={`message ${msg.role}`}>\n          <StreamingMarkdown text={msg.content} />\n        </div>\n      ))}\n      {currentAssistant && (\n        <div className=\"message assistant streaming\">\n          <StreamingMarkdown text={currentAssistant} />\n        </div>\n      )}\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "4daf2cbe",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 2: Code Block with Copy Button",
        "range": {
          "from": 26864,
          "to": 26906
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 2: Code Block with Copy Button",
          "headingId": "pattern-2-code-block-with-copy-button"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 2: Code Block with Copy Button"
          }
        ]
      }
    },
    {
      "id": "b1ecbb7",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport type { BlockComponents } from \"stream-mdx\";\n\nconst components: Partial<BlockComponents> = {\n  code: ({ html, meta }) => {\n    const code = meta?.rawCode as string || \"\";\n    const lang = meta?.lang as string || \"text\";\n\n    return (\n      <div className=\"relative group\">\n        <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n          <button\n            onClick={() => {\n              navigator.clipboard.writeText(code);\n              // Show toast notification\n            }}\n            className=\"px-2 py-1 text-xs bg-gray-800 text-white rounded\"\n          >\n            Copy\n          </button>\n        </div>\n        <div\n          className=\"code-block\"\n          dangerouslySetInnerHTML={{ __html: html || \"\" }}\n        />\n      </div>\n    );\n  },\n};\n\n<StreamingMarkdown text={content} components={components} />\n```",
        "range": {
          "from": 26908,
          "to": 27844
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { BlockComponents } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> components</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> Partial</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">BlockComponents</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  code</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">: ({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">html</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">meta</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> code</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> meta?.rawCode </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">as</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> ||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> lang</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> meta?.lang </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">as</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> ||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"text\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"8\"></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"relative group\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">            onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">              navigator.clipboard.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">writeText</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(code);</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">              // Show toast notification</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            }}</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">            className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"px-2 py-1 text-xs bg-gray-800 text-white rounded\"</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          ></span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            Copy</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"code-block\"</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          dangerouslySetInnerHTML</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ __html: html </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">||</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        /></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    );</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  },</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">};</span></span>\n<span class=\"line\" data-line=\"30\"></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">components</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{components} /></span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport type { BlockComponents } from \"stream-mdx\";\n\nconst components: Partial<BlockComponents> = {\n  code: ({ html, meta }) => {\n    const code = meta?.rawCode as string || \"\";\n    const lang = meta?.lang as string || \"text\";\n\n    return (\n      <div className=\"relative group\">\n        <div className=\"absolute top-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity\">\n          <button\n            onClick={() => {\n              navigator.clipboard.writeText(code);\n              // Show toast notification\n            }}\n            className=\"px-2 py-1 text-xs bg-gray-800 text-white rounded\"\n          >\n            Copy\n          </button>\n        </div>\n        <div\n          className=\"code-block\"\n          dangerouslySetInnerHTML={{ __html: html || \"\" }}\n        />\n      </div>\n    );\n  },\n};\n\n<StreamingMarkdown text={content} components={components} />"
        }
      }
    },
    {
      "id": "6078b9b",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 3: Loading States",
        "range": {
          "from": 27846,
          "to": 27875
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 3: Loading States",
          "headingId": "pattern-3-loading-states"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 3: Loading States"
          }
        ]
      }
    },
    {
      "id": "57e72bff",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\nimport { useRef, useState, useEffect } from \"react\";\n\nexport function StreamingWithLoading({ stream }: { stream: AsyncIterable<string> }) {\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n  const [isStreaming, setIsStreaming] = useState(true);\n\n  useEffect(() => {\n    // Monitor streaming state\n    const checkInterval = setInterval(async () => {\n      const state = handleRef.current?.getState();\n      if (state && state.queueDepth === 0 && state.pendingBatches === 0) {\n        setIsStreaming(false);\n        clearInterval(checkInterval);\n      }\n    }, 100);\n\n    return () => clearInterval(checkInterval);\n  }, []);\n\n  return (\n    <div>\n      {isStreaming && (\n        <div className=\"loading-indicator\">\n          <span>Streaming...</span>\n        </div>\n      )}\n      <StreamingMarkdown\n        ref={handleRef}\n        stream={stream}\n      />\n    </div>\n  );\n}\n```",
        "range": {
          "from": 27877,
          "to": 28848
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown, </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">type</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> StreamingMarkdownHandle } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useRef, useState, useEffect } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> StreamingWithLoading</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> AsyncIterable</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> handleRef</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useRef</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">StreamingMarkdownHandle</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">isStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setIsStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"7\"></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Monitor streaming state</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> checkInterval</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">async</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> () </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> state</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> handleRef.current?.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">getState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (state </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> state.queueDepth </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">===</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 0</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> &#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> state.pendingBatches </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">===</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 0</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        setIsStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">false</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        clearInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(checkInterval);</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      }</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">100</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"17\"></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> () </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> clearInterval</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(checkInterval);</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, []);</span></span>\n<span class=\"line\" data-line=\"20\"></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {isStreaming </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"loading-indicator\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">span</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>Streaming...&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">span</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      )}</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        ref</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{handleRef}</span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{stream}</span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      /></span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown, type StreamingMarkdownHandle } from \"stream-mdx\";\nimport { useRef, useState, useEffect } from \"react\";\n\nexport function StreamingWithLoading({ stream }: { stream: AsyncIterable<string> }) {\n  const handleRef = useRef<StreamingMarkdownHandle>(null);\n  const [isStreaming, setIsStreaming] = useState(true);\n\n  useEffect(() => {\n    // Monitor streaming state\n    const checkInterval = setInterval(async () => {\n      const state = handleRef.current?.getState();\n      if (state && state.queueDepth === 0 && state.pendingBatches === 0) {\n        setIsStreaming(false);\n        clearInterval(checkInterval);\n      }\n    }, 100);\n\n    return () => clearInterval(checkInterval);\n  }, []);\n\n  return (\n    <div>\n      {isStreaming && (\n        <div className=\"loading-indicator\">\n          <span>Streaming...</span>\n        </div>\n      )}\n      <StreamingMarkdown\n        ref={handleRef}\n        stream={stream}\n      />\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "7c58f0dd",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Pattern 4: Error Handling",
        "range": {
          "from": 28850,
          "to": 28879
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Pattern 4: Error Handling",
          "headingId": "pattern-4-error-handling"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Pattern 4: Error Handling"
          }
        ]
      }
    },
    {
      "id": "67066a89",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { StreamingMarkdown } from \"stream-mdx\";\nimport { useState } from \"react\";\n\nexport function StreamingWithErrorHandling({ stream }: { stream: AsyncIterable<string> }) {\n  const [error, setError] = useState<Error | null>(null);\n\n  return (\n    <div>\n      {error && (\n        <div className=\"error-banner\">\n          Error: {error.message}\n          <button onClick={() => setError(null)}>Dismiss</button>\n        </div>\n      )}\n      <StreamingMarkdown\n        stream={stream}\n        onError={(err) => {\n          setError(err);\n          console.error(\"Markdown render error:\", err);\n        }}\n      />\n    </div>\n  );\n}\n```",
        "range": {
          "from": 28881,
          "to": 29522
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> StreamingWithErrorHandling</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> AsyncIterable</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">error</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setError</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">Error</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> |</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      {error </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"error-banner\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          Error: {error.message}</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setError</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">null</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">)}>Dismiss&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      )}</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        stream</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{stream}</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">        onError</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">err</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          setError</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(err);</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          console.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">error</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Markdown render error:\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, err);</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        }}</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      /></span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { StreamingMarkdown } from \"stream-mdx\";\nimport { useState } from \"react\";\n\nexport function StreamingWithErrorHandling({ stream }: { stream: AsyncIterable<string> }) {\n  const [error, setError] = useState<Error | null>(null);\n\n  return (\n    <div>\n      {error && (\n        <div className=\"error-banner\">\n          Error: {error.message}\n          <button onClick={() => setError(null)}>Dismiss</button>\n        </div>\n      )}\n      <StreamingMarkdown\n        stream={stream}\n        onError={(err) => {\n          setError(err);\n          console.error(\"Markdown render error:\", err);\n        }}\n      />\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "4ba613a4",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 29524,
          "to": 29527
        }
      }
    },
    {
      "id": "1ee811a5",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Complete Examples",
        "range": {
          "from": 29529,
          "to": 29549
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Complete Examples",
          "headingId": "complete-examples"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Complete Examples"
          }
        ]
      }
    },
    {
      "id": "59a0ecfa",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Example 1: Full-Featured Chat Interface",
        "range": {
          "from": 29551,
          "to": 29594
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Example 1: Full-Featured Chat Interface",
          "headingId": "example-1-full-featured-chat-interface"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Example 1: Full-Featured Chat Interface"
          }
        ]
      }
    },
    {
      "id": "115c949",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function FullChatInterface() {\n  const [messages, setMessages] = useState<Array<{ role: string; content: string }>>([]);\n  const [input, setInput] = useState(\"\");\n  const [streaming, setStreaming] = useState(\"\");\n\n  const markdownProps = {\n    worker: \"/workers/markdown-worker.js\",\n    features: { math: true, mdx: true, tables: true, html: true },\n    mdxCompileMode: \"worker\" as const,\n    prewarmLangs: [\"typescript\", \"bash\", \"python\"],\n  };\n\n  async function handleSubmit() {\n    if (!input.trim()) return;\n\n    const userMessage = input;\n    setInput(\"\");\n    setMessages(prev => [...prev, { role: \"user\", content: userMessage }]);\n\n    // Stream response\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: userMessage }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let content = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n      content += decoder.decode(value, { stream: true });\n      setStreaming(content);\n    }\n\n    setMessages(prev => [...prev, { role: \"assistant\", content }]);\n    setStreaming(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"messages\">\n        {messages.map((msg, i) => (\n          <div key={i} className={`message ${msg.role}`}>\n            <StreamingMarkdown\n              text={msg.content}\n              {...markdownProps}\n            />\n          </div>\n        ))}\n        {streaming && (\n          <div className=\"message assistant streaming\">\n            <StreamingMarkdown\n              text={streaming}\n              {...markdownProps}\n            />\n          </div>\n        )}\n      </div>\n      <div className=\"input-area\">\n        <input\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyDown={(e) => e.key === \"Enter\" && handleSubmit()}\n          placeholder=\"Type your message...\"\n        />\n        <button onClick={handleSubmit}>Send</button>\n      </div>\n    </div>\n  );\n}\n```",
        "range": {
          "from": 29596,
          "to": 31761
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> FullChatInterface</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">messages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">Array</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;{ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">role</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">; </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">content</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }>>([]);</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">input</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setInput</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"7\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">streaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"8\"></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> markdownProps</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    worker: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/workers/markdown-worker.js\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    features: { math: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, mdx: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, tables: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, html: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> },</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    mdxCompileMode: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"worker\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> as</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"13\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    prewarmLangs: [</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"python\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">],</span></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  };</span></span>\n<span class=\"line\" data-line=\"15\"></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  async</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> handleSubmit</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">() {</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">input.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">trim</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">()) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"18\"></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> userMessage</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> input;</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setInput</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, { role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"user\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, content: userMessage }]);</span></span>\n<span class=\"line\" data-line=\"22\"></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">    // Stream response</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> response</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> fetch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"/api/chat\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, {</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      method: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"POST\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"26\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      body: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">JSON</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">stringify</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ message: userMessage }),</span></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    });</span></span>\n<span class=\"line\" data-line=\"28\"></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> reader</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> response.body</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">!</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">getReader</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> decoder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> new</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> TextDecoder</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    let</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> content </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"32\"></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    while</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) {</span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">done</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">value</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> await</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> reader.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">read</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">();</span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">      if</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (done) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">break</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      content </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> decoder.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">decode</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(value, { stream: </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">true</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> });</span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">      setStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(content);</span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    }</span></span>\n<span class=\"line\" data-line=\"39\"></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setMessages</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">prev</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">prev, { role: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"assistant\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, content }]);</span></span>\n<span class=\"line\" data-line=\"41\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setStreaming</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"42\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }</span></span>\n<span class=\"line\" data-line=\"43\"></span>\n<span class=\"line\" data-line=\"44\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"45\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"chat-container\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"46\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"messages\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"47\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        {messages.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">map</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">((</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">msg</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">i</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"48\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> key</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{i} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`message ${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">msg</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">role</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}></span></span>\n<span class=\"line\" data-line=\"49\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"50\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">              text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{msg.content}</span></span>\n<span class=\"line\" data-line=\"51\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">              {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">markdownProps}</span></span>\n<span class=\"line\" data-line=\"52\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            /></span></span>\n<span class=\"line\" data-line=\"53\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"54\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        ))}</span></span>\n<span class=\"line\" data-line=\"55\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        {streaming </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">&#x26;&#x26;</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"56\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"message assistant streaming\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"57\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"58\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">              text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{streaming}</span></span>\n<span class=\"line\" data-line=\"59\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">              {</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">...</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">markdownProps}</span></span>\n<span class=\"line\" data-line=\"60\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            /></span></span>\n<span class=\"line\" data-line=\"61\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"62\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        )}</span></span>\n<span class=\"line\" data-line=\"63\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"64\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"input-area\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"65\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">input</span></span>\n<span class=\"line\" data-line=\"66\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          value</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{input}</span></span>\n<span class=\"line\" data-line=\"67\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          onChange</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">e</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> setInput</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(e.target.value)}</span></span>\n<span class=\"line\" data-line=\"68\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          onKeyDown</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">e</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> e.key </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">===</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"Enter\"</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> &#x26;&#x26;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> handleSubmit</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">()}</span></span>\n<span class=\"line\" data-line=\"69\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          placeholder</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"Type your message...\"</span></span>\n<span class=\"line\" data-line=\"70\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        /></span></span>\n<span class=\"line\" data-line=\"71\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> onClick</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{handleSubmit}>Send&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">button</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"72\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"73\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"74\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"75\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function FullChatInterface() {\n  const [messages, setMessages] = useState<Array<{ role: string; content: string }>>([]);\n  const [input, setInput] = useState(\"\");\n  const [streaming, setStreaming] = useState(\"\");\n\n  const markdownProps = {\n    worker: \"/workers/markdown-worker.js\",\n    features: { math: true, mdx: true, tables: true, html: true },\n    mdxCompileMode: \"worker\" as const,\n    prewarmLangs: [\"typescript\", \"bash\", \"python\"],\n  };\n\n  async function handleSubmit() {\n    if (!input.trim()) return;\n\n    const userMessage = input;\n    setInput(\"\");\n    setMessages(prev => [...prev, { role: \"user\", content: userMessage }]);\n\n    // Stream response\n    const response = await fetch(\"/api/chat\", {\n      method: \"POST\",\n      body: JSON.stringify({ message: userMessage }),\n    });\n\n    const reader = response.body!.getReader();\n    const decoder = new TextDecoder();\n    let content = \"\";\n\n    while (true) {\n      const { done, value } = await reader.read();\n      if (done) break;\n      content += decoder.decode(value, { stream: true });\n      setStreaming(content);\n    }\n\n    setMessages(prev => [...prev, { role: \"assistant\", content }]);\n    setStreaming(\"\");\n  }\n\n  return (\n    <div className=\"chat-container\">\n      <div className=\"messages\">\n        {messages.map((msg, i) => (\n          <div key={i} className={`message ${msg.role}`}>\n            <StreamingMarkdown\n              text={msg.content}\n              {...markdownProps}\n            />\n          </div>\n        ))}\n        {streaming && (\n          <div className=\"message assistant streaming\">\n            <StreamingMarkdown\n              text={streaming}\n              {...markdownProps}\n            />\n          </div>\n        )}\n      </div>\n      <div className=\"input-area\">\n        <input\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyDown={(e) => e.key === \"Enter\" && handleSubmit()}\n          placeholder=\"Type your message...\"\n        />\n        <button onClick={handleSubmit}>Send</button>\n      </div>\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "51327d26",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Example 2: Documentation Viewer with TOC",
        "range": {
          "from": 31763,
          "to": 31807
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Example 2: Documentation Viewer with TOC",
          "headingId": "example-2-documentation-viewer-with-toc"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Example 2: Documentation Viewer with TOC"
          }
        ]
      }
    },
    {
      "id": "4c1a426f",
      "type": "code",
      "isFinalized": true,
      "payload": {
        "raw": "```tsx\nimport { useState, useEffect } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function DocumentationViewer({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n  const [headings, setHeadings] = useState<Array<{ id: string; text: string; level: number }>>([]);\n\n  useEffect(() => {\n    fetch(url)\n      .then(res => res.text())\n      .then(setContent);\n  }, [url]);\n\n  // Extract headings for TOC (simplified)\n  useEffect(() => {\n    const headingRegex = /^(#{1,6})\\s+(.+)$/gm;\n    const matches = Array.from(content.matchAll(headingRegex));\n    setHeadings(\n      matches.map((match, i) => ({\n        id: `heading-${i}`,\n        text: match[2],\n        level: match[1].length,\n      }))\n    );\n  }, [content]);\n\n  return (\n    <div className=\"docs-container\">\n      <aside className=\"toc\">\n        <h2>Table of Contents</h2>\n        <ul>\n          {headings.map(heading => (\n            <li key={heading.id} style={{ paddingLeft: `${(heading.level - 1) * 1}rem` }}>\n              <a href={`#${heading.id}`}>{heading.text}</a>\n            </li>\n          ))}\n        </ul>\n      </aside>\n      <main className=\"content\">\n        <StreamingMarkdown\n          text={content}\n          prewarmLangs={[\"typescript\", \"bash\", \"markdown\"]}\n        />\n      </main>\n    </div>\n  );\n}\n```",
        "range": {
          "from": 31809,
          "to": 33138
        },
        "highlightedHtml": "<pre class=\"shiki shiki-themes github-dark github-light\" style=\"--shiki-dark:#e1e4e8;--shiki-light:#24292e;--shiki-dark-bg: transparent;--shiki-light-bg: transparent\" tabindex=\"undefined\" data-language=\"tsx\"><code data-language=\"tsx\" data-theme=\"github-dark github-light\" style=\"display: grid;\"><span class=\"line\" data-line=\"1\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { useState, useEffect } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"react\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"2\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">import</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { StreamingMarkdown } </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">from</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> \"stream-mdx\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"3\"></span>\n<span class=\"line\" data-line=\"4\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">export</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> function</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> DocumentationViewer</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">({ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> { </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">url</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }) {</span></span>\n<span class=\"line\" data-line=\"5\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">content</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setContent</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">);</span></span>\n<span class=\"line\" data-line=\"6\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  const</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> [</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">headings</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">setHeadings</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">] </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> useState</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">Array</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">&#x3C;{ </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">id</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">; </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> string</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">; </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">level</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">:</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> number</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }>>([]);</span></span>\n<span class=\"line\" data-line=\"7\"></span>\n<span class=\"line\" data-line=\"8\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"9\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    fetch</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(url)</span></span>\n<span class=\"line\" data-line=\"10\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      .</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">then</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">res</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> res.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">text</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">())</span></span>\n<span class=\"line\" data-line=\"11\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      .</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">then</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(setContent);</span></span>\n<span class=\"line\" data-line=\"12\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, [url]);</span></span>\n<span class=\"line\" data-line=\"13\"></span>\n<span class=\"line\" data-line=\"14\"><span style=\"--shiki-dark:#6A737D;--shiki-light:#6A737D\">  // Extract headings for TOC (simplified)</span></span>\n<span class=\"line\" data-line=\"15\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">  useEffect</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(() </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> {</span></span>\n<span class=\"line\" data-line=\"16\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> headingRegex</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\"> /</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">^</span><span style=\"--shiki-dark:#DBEDFF;--shiki-light:#032F62\">(#</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">{1,6}</span><span style=\"--shiki-dark:#DBEDFF;--shiki-light:#032F62\">)</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">\\s</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#DBEDFF;--shiki-light:#032F62\">(</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">.</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">+</span><span style=\"--shiki-dark:#DBEDFF;--shiki-light:#032F62\">)</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">$</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">/</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">gm</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">;</span></span>\n<span class=\"line\" data-line=\"17\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">    const</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> matches</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> Array.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">from</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(content.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">matchAll</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(headingRegex));</span></span>\n<span class=\"line\" data-line=\"18\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">    setHeadings</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span></span>\n<span class=\"line\" data-line=\"19\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      matches.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">map</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">((</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">match</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">i</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> ({</span></span>\n<span class=\"line\" data-line=\"20\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        id: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`heading-${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">i</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"21\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        text: match[</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">],</span></span>\n<span class=\"line\" data-line=\"22\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        level: match[</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">1</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">].</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">length</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">,</span></span>\n<span class=\"line\" data-line=\"23\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      }))</span></span>\n<span class=\"line\" data-line=\"24\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    );</span></span>\n<span class=\"line\" data-line=\"25\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  }, [content]);</span></span>\n<span class=\"line\" data-line=\"26\"></span>\n<span class=\"line\" data-line=\"27\"><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">  return</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"28\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"docs-container\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"29\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">aside</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"toc\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"30\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">h2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">>Table of Contents&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">h2</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"31\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">ul</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"32\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          {headings.</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">map</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">(</span><span style=\"--shiki-dark:#FFAB70;--shiki-light:#E36209\">heading</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> =></span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> (</span></span>\n<span class=\"line\" data-line=\"33\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">li</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> key</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{heading.id} </span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">style</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{{ paddingLeft: </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`${</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">(</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">heading</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">level</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\"> -</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 1</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">) </span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">*</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\"> 1</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}rem`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\"> }}></span></span>\n<span class=\"line\" data-line=\"34\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">              &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">a</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> href</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">`#${</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">heading</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">.</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">id</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">}`</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}>{heading.text}&#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">a</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"35\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">            &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">li</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"36\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">          ))}</span></span>\n<span class=\"line\" data-line=\"37\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">ul</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"38\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">aside</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"39\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">main</span><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\"> className</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"content\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"40\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        &#x3C;</span><span style=\"--shiki-dark:#79B8FF;--shiki-light:#005CC5\">StreamingMarkdown</span></span>\n<span class=\"line\" data-line=\"41\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          text</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{content}</span></span>\n<span class=\"line\" data-line=\"42\"><span style=\"--shiki-dark:#B392F0;--shiki-light:#6F42C1\">          prewarmLangs</span><span style=\"--shiki-dark:#F97583;--shiki-light:#D73A49\">=</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">{[</span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"typescript\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"bash\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">, </span><span style=\"--shiki-dark:#9ECBFF;--shiki-light:#032F62\">\"markdown\"</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">]}</span></span>\n<span class=\"line\" data-line=\"43\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">        /></span></span>\n<span class=\"line\" data-line=\"44\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">      &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">main</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"45\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">    &#x3C;/</span><span style=\"--shiki-dark:#85E89D;--shiki-light:#22863A\">div</span><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">></span></span>\n<span class=\"line\" data-line=\"46\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">  );</span></span>\n<span class=\"line\" data-line=\"47\"><span style=\"--shiki-dark:#E1E4E8;--shiki-light:#24292E\">}</span></span></code></pre>",
        "meta": {
          "lang": "tsx",
          "code": "import { useState, useEffect } from \"react\";\nimport { StreamingMarkdown } from \"stream-mdx\";\n\nexport function DocumentationViewer({ url }: { url: string }) {\n  const [content, setContent] = useState(\"\");\n  const [headings, setHeadings] = useState<Array<{ id: string; text: string; level: number }>>([]);\n\n  useEffect(() => {\n    fetch(url)\n      .then(res => res.text())\n      .then(setContent);\n  }, [url]);\n\n  // Extract headings for TOC (simplified)\n  useEffect(() => {\n    const headingRegex = /^(#{1,6})\\s+(.+)$/gm;\n    const matches = Array.from(content.matchAll(headingRegex));\n    setHeadings(\n      matches.map((match, i) => ({\n        id: `heading-${i}`,\n        text: match[2],\n        level: match[1].length,\n      }))\n    );\n  }, [content]);\n\n  return (\n    <div className=\"docs-container\">\n      <aside className=\"toc\">\n        <h2>Table of Contents</h2>\n        <ul>\n          {headings.map(heading => (\n            <li key={heading.id} style={{ paddingLeft: `${(heading.level - 1) * 1}rem` }}>\n              <a href={`#${heading.id}`}>{heading.text}</a>\n            </li>\n          ))}\n        </ul>\n      </aside>\n      <main className=\"content\">\n        <StreamingMarkdown\n          text={content}\n          prewarmLangs={[\"typescript\", \"bash\", \"markdown\"]}\n        />\n      </main>\n    </div>\n  );\n}"
        }
      }
    },
    {
      "id": "6f68d807",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 33140,
          "to": 33143
        }
      }
    },
    {
      "id": "232f9322",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Troubleshooting",
        "range": {
          "from": 33145,
          "to": 33163
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Troubleshooting",
          "headingId": "troubleshooting"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Troubleshooting"
          }
        ]
      }
    },
    {
      "id": "bc27560",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Worker Not Loading",
        "range": {
          "from": 33165,
          "to": 33187
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Worker Not Loading",
          "headingId": "worker-not-loading"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Worker Not Loading"
          }
        ]
      }
    },
    {
      "id": "76e39586",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Problem**: Worker fails to initialize or CSP errors.",
        "range": {
          "from": 33189,
          "to": 33243
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Problem"
              }
            ]
          },
          {
            "kind": "text",
            "text": ": Worker fails to initialize or CSP errors."
          }
        ]
      }
    },
    {
      "id": "546107b",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Solutions**:",
        "range": {
          "from": 33245,
          "to": 33259
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Solutions"
              }
            ]
          },
          {
            "kind": "text",
            "text": ":"
          }
        ]
      }
    },
    {
      "id": "1a309458",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Use a hosted worker URL instead of Blob (recommended):\n  ```tsx\n  <StreamingMarkdown\n    worker=\"/workers/markdown-worker.js\"\n  />\n  ```\n- Check CSP headers allow worker execution\n- Verify worker file is served correctly",
        "range": {
          "from": 33260,
          "to": 33482
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Use a hosted worker URL instead of Blob (recommended):\n```tsx\n<StreamingMarkdown\nworker=\"/workers/markdown-worker.js\"\n/>\n```"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Check CSP headers allow worker execution"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Verify worker file is served correctly"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "1ebf00e0",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Performance Issues",
        "range": {
          "from": 33484,
          "to": 33506
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Performance Issues",
          "headingId": "performance-issues"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Performance Issues"
          }
        ]
      }
    },
    {
      "id": "70b6a6c5",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Problem**: Slow rendering or janky updates.",
        "range": {
          "from": 33508,
          "to": 33553
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Problem"
              }
            ]
          },
          {
            "kind": "text",
            "text": ": Slow rendering or janky updates."
          }
        ]
      }
    },
    {
      "id": "277f36a3",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Solutions**:",
        "range": {
          "from": 33555,
          "to": 33569
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Solutions"
              }
            ]
          },
          {
            "kind": "text",
            "text": ":"
          }
        ]
      }
    },
    {
      "id": "52592d86",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Reduce `frameBudgetMs` or add batch caps in `scheduling`\n- Prewarm common languages\n- Monitor metrics and adjust frame budget\n- Use virtualization for long documents",
        "range": {
          "from": 33570,
          "to": 33737
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Reduce "
              },
              {
                "kind": "code",
                "text": "frameBudgetMs"
              },
              {
                "kind": "text",
                "text": " or add batch caps in "
              },
              {
                "kind": "code",
                "text": "scheduling"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Prewarm common languages"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Monitor metrics and adjust frame budget"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Use virtualization for long documents"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "2abf173",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Custom Plugins Not Working",
        "range": {
          "from": 33739,
          "to": 33769
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Custom Plugins Not Working",
          "headingId": "custom-plugins-not-working"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Custom Plugins Not Working"
          }
        ]
      }
    },
    {
      "id": "71575619",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Problem**: Custom syntax not being recognized.",
        "range": {
          "from": 33771,
          "to": 33819
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Problem"
              }
            ]
          },
          {
            "kind": "text",
            "text": ": Custom syntax not being recognized."
          }
        ]
      }
    },
    {
      "id": "396221bf",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Solutions**:",
        "range": {
          "from": 33821,
          "to": 33835
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Solutions"
              }
            ]
          },
          {
            "kind": "text",
            "text": ":"
          }
        ]
      }
    },
    {
      "id": "3f5f2527",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- StreamMDX only exposes built-in domains via `features` on `<StreamingMarkdown />`.\n- For custom syntax you need a custom worker bundle that registers your plugins; then pass that worker URL via `worker`.\n- Use `inlineComponents` / `components` to render any custom nodes emitted by your worker.",
        "range": {
          "from": 33836,
          "to": 34132
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "StreamMDX only exposes built-in domains via "
              },
              {
                "kind": "code",
                "text": "features"
              },
              {
                "kind": "text",
                "text": " on "
              },
              {
                "kind": "code",
                "text": "<StreamingMarkdown />"
              },
              {
                "kind": "text",
                "text": "."
              }
            ],
            [
              {
                "kind": "text",
                "text": "For custom syntax you need a custom worker bundle that registers your plugins; then pass that worker URL via "
              },
              {
                "kind": "code",
                "text": "worker"
              },
              {
                "kind": "text",
                "text": "."
              }
            ],
            [
              {
                "kind": "text",
                "text": "Use "
              },
              {
                "kind": "code",
                "text": "inlineComponents"
              },
              {
                "kind": "text",
                "text": " / "
              },
              {
                "kind": "code",
                "text": "components"
              },
              {
                "kind": "text",
                "text": " to render any custom nodes emitted by your worker."
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "5daca79f",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "MDX Not Compiling",
        "range": {
          "from": 34134,
          "to": 34155
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "MDX Not Compiling",
          "headingId": "mdx-not-compiling"
        },
        "inline": [
          {
            "kind": "text",
            "text": "MDX Not Compiling"
          }
        ]
      }
    },
    {
      "id": "2a1bde7a",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Problem**: MDX blocks show as raw code.",
        "range": {
          "from": 34157,
          "to": 34198
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Problem"
              }
            ]
          },
          {
            "kind": "text",
            "text": ": MDX blocks show as raw code."
          }
        ]
      }
    },
    {
      "id": "201a3927",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Solutions**:",
        "range": {
          "from": 34200,
          "to": 34214
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Solutions"
              }
            ]
          },
          {
            "kind": "text",
            "text": ":"
          }
        ]
      }
    },
    {
      "id": "7a1ced7f",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Set `features={{ mdx: true }}`\n- Set `mdxCompileMode=\"worker\"` (no server) or `mdxCompileMode=\"server\"` (requires `/api/mdx-compile-v2`)\n- Check MDX compilation endpoint is working\n- Verify you passed `mdxComponents` for your custom MDX components",
        "range": {
          "from": 34215,
          "to": 34464
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "features={{ mdx: true }}"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Set "
              },
              {
                "kind": "code",
                "text": "mdxCompileMode=\"worker\""
              },
              {
                "kind": "text",
                "text": " (no server) or "
              },
              {
                "kind": "code",
                "text": "mdxCompileMode=\"server\""
              },
              {
                "kind": "text",
                "text": " (requires "
              },
              {
                "kind": "code",
                "text": "/api/mdx-compile-v2"
              },
              {
                "kind": "text",
                "text": ")"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Check MDX compilation endpoint is working"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Verify you passed "
              },
              {
                "kind": "code",
                "text": "mdxComponents"
              },
              {
                "kind": "text",
                "text": " for your custom MDX components"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "6666a203",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Colors Not Showing in Code Blocks",
        "range": {
          "from": 34466,
          "to": 34503
        },
        "meta": {
          "headingLevel": 3,
          "headingText": "Colors Not Showing in Code Blocks",
          "headingId": "colors-not-showing-in-code-blocks"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Colors Not Showing in Code Blocks"
          }
        ]
      }
    },
    {
      "id": "6c19a7df",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Problem**: Code blocks render without syntax highlighting.",
        "range": {
          "from": 34505,
          "to": 34565
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Problem"
              }
            ]
          },
          {
            "kind": "text",
            "text": ": Code blocks render without syntax highlighting."
          }
        ]
      }
    },
    {
      "id": "14266223",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "**Solutions**:",
        "range": {
          "from": 34567,
          "to": 34581
        },
        "inline": [
          {
            "kind": "strong",
            "children": [
              {
                "kind": "text",
                "text": "Solutions"
              }
            ]
          },
          {
            "kind": "text",
            "text": ":"
          }
        ]
      }
    },
    {
      "id": "1eed8906",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Ensure language is in `prewarmLangs`\n- Check Shiki theme is loaded\n- Verify `highlightedHtml` is present in block payload\n- Check browser console for highlighting errors",
        "range": {
          "from": 34582,
          "to": 34753
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Ensure language is in "
              },
              {
                "kind": "code",
                "text": "prewarmLangs"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Check Shiki theme is loaded"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Verify "
              },
              {
                "kind": "code",
                "text": "highlightedHtml"
              },
              {
                "kind": "text",
                "text": " is present in block payload"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Check browser console for highlighting errors"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "51637ba2",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 34755,
          "to": 34758
        }
      }
    },
    {
      "id": "5485dfc0",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Next Steps",
        "range": {
          "from": 34760,
          "to": 34773
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Next Steps",
          "headingId": "next-steps"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Next Steps"
          }
        ]
      }
    },
    {
      "id": "4117cea0",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "1. **Read the Public API docs**: `docs/PUBLIC_API.md`\n2. **Worker + CSP notes**: `docs/STREAMING_MARKDOWN_V2_STATUS.md`\n3. **MDX + customization**: `docs/STREAMING_MARKDOWN_PLUGINS_COOKBOOK.md`\n4. **Release checklist**: `docs/STREAMING_MARKDOWN_RELEASE_CHECKLIST.md`\n5. **Review examples**: `examples/streaming-markdown-starter`",
        "range": {
          "from": 34775,
          "to": 35103
        },
        "meta": {
          "ordered": true,
          "items": [
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Read the Public API docs"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": "
              },
              {
                "kind": "code",
                "text": "docs/PUBLIC_API.md"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Worker + CSP notes"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": "
              },
              {
                "kind": "code",
                "text": "docs/STREAMING_MARKDOWN_V2_STATUS.md"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "MDX + customization"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": "
              },
              {
                "kind": "code",
                "text": "docs/STREAMING_MARKDOWN_PLUGINS_COOKBOOK.md"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Release checklist"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": "
              },
              {
                "kind": "code",
                "text": "docs/STREAMING_MARKDOWN_RELEASE_CHECKLIST.md"
              }
            ],
            [
              {
                "kind": "strong",
                "children": [
                  {
                    "kind": "text",
                    "text": "Review examples"
                  }
                ]
              },
              {
                "kind": "text",
                "text": ": "
              },
              {
                "kind": "code",
                "text": "examples/streaming-markdown-starter"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "2700c9a0",
      "type": "hr",
      "isFinalized": true,
      "payload": {
        "raw": "---",
        "range": {
          "from": 35105,
          "to": 35108
        }
      }
    },
    {
      "id": "70605f7e",
      "type": "heading",
      "isFinalized": true,
      "payload": {
        "raw": "Summary",
        "range": {
          "from": 35110,
          "to": 35120
        },
        "meta": {
          "headingLevel": 2,
          "headingText": "Summary",
          "headingId": "summary"
        },
        "inline": [
          {
            "kind": "text",
            "text": "Summary"
          }
        ]
      }
    },
    {
      "id": "c6d3a37",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "You now have everything you need to:",
        "range": {
          "from": 35122,
          "to": 35158
        },
        "inline": [
          {
            "kind": "text",
            "text": "You now have everything you need to:"
          }
        ]
      }
    },
    {
      "id": "5988e335",
      "type": "list",
      "isFinalized": true,
      "payload": {
        "raw": "- Render streaming markdown (basic and advanced patterns)\n- Stream from LLMs/APIs (fetch, WebSocket, SSE examples)\n- Customize components (block and inline overrides)\n- Extend syntax via custom worker bundles (advanced)\n- Integrate MDX (server and worker compilation)\n- Optimize performance (metrics, scheduling, prewarming)",
        "range": {
          "from": 35160,
          "to": 35484
        },
        "meta": {
          "ordered": false,
          "items": [
            [
              {
                "kind": "text",
                "text": "Render streaming markdown (basic and advanced patterns)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Stream from LLMs/APIs (fetch, WebSocket, SSE examples)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Customize components (block and inline overrides)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Extend syntax via custom worker bundles (advanced)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Integrate MDX (server and worker compilation)"
              }
            ],
            [
              {
                "kind": "text",
                "text": "Optimize performance (metrics, scheduling, prewarming)"
              }
            ]
          ],
          "mathEnabled": true
        }
      }
    },
    {
      "id": "59b2f8f8",
      "type": "paragraph",
      "isFinalized": true,
      "payload": {
        "raw": "StreamMDX is designed for production React applications; start with the defaults, then tighten CSP and tuning knobs as you scale.",
        "range": {
          "from": 35486,
          "to": 35615
        },
        "inline": [
          {
            "kind": "text",
            "text": "StreamMDX is designed for production React applications; start with the defaults, then tighten CSP and tuning knobs as you scale."
          }
        ]
      }
    }
  ],
  "tocHeadings": [
    {
      "id": "react-integration-guide-streammdx",
      "text": "React Integration Guide ‚Äî StreamMDX",
      "level": 1,
      "blockId": "db082c0"
    },
    {
      "id": "table-of-contents",
      "text": "Table of Contents",
      "level": 2,
      "blockId": "7d13b97d"
    },
    {
      "id": "overview",
      "text": "Overview",
      "level": 2,
      "blockId": "5ae847c8"
    },
    {
      "id": "key-features",
      "text": "Key Features",
      "level": 3,
      "blockId": "6e7f5103"
    },
    {
      "id": "quick-start",
      "text": "Quick Start",
      "level": 2,
      "blockId": "57c0ac42"
    },
    {
      "id": "installation",
      "text": "Installation",
      "level": 3,
      "blockId": "3a5b4899"
    },
    {
      "id": "worker-bundle-placement",
      "text": "Worker bundle placement",
      "level": 3,
      "blockId": "fc90ba6"
    },
    {
      "id": "minimal-example",
      "text": "Minimal Example",
      "level": 3,
      "blockId": "220c1cdf"
    },
    {
      "id": "with-streaming",
      "text": "With Streaming",
      "level": 3,
      "blockId": "5d918661"
    },
    {
      "id": "static-ssr-rendering-server-safe-entrypoint",
      "text": "Static / SSR Rendering (server-safe entrypoint)",
      "level": 3,
      "blockId": "2936b505"
    },
    {
      "id": "edge-no-worker-threads",
      "text": "Edge / No-worker Threads",
      "level": 3,
      "blockId": "547bc6dd"
    },
    {
      "id": "core-concepts",
      "text": "Core Concepts",
      "level": 2,
      "blockId": "7ff15c9f"
    },
    {
      "id": "architecture",
      "text": "Architecture",
      "level": 3,
      "blockId": "3ffb60db"
    },
    {
      "id": "key-props",
      "text": "Key Props",
      "level": 3,
      "blockId": "7ca5a1bb"
    },
    {
      "id": "streaming-behavior",
      "text": "Streaming Behavior",
      "level": 3,
      "blockId": "3233c79e"
    },
    {
      "id": "basic-usage-patterns",
      "text": "Basic Usage Patterns",
      "level": 2,
      "blockId": "794d413b"
    },
    {
      "id": "pattern-1-static-content",
      "text": "Pattern 1: Static Content",
      "level": 3,
      "blockId": "7e38e71d"
    },
    {
      "id": "pattern-2-controlled-updates",
      "text": "Pattern 2: Controlled Updates",
      "level": 3,
      "blockId": "20f58898"
    },
    {
      "id": "pattern-3-streaming-from-state",
      "text": "Pattern 3: Streaming from State",
      "level": 3,
      "blockId": "7db863ba"
    },
    {
      "id": "streaming-from-llm-api",
      "text": "Streaming from LLM/API",
      "level": 2,
      "blockId": "56165e4b"
    },
    {
      "id": "pattern-1-fetch-stream",
      "text": "Pattern 1: Fetch Stream",
      "level": 3,
      "blockId": "360757f1"
    },
    {
      "id": "pattern-2-websocket-stream",
      "text": "Pattern 2: WebSocket Stream",
      "level": 3,
      "blockId": "42a2fedc"
    },
    {
      "id": "pattern-3-sse-server-sent-events",
      "text": "Pattern 3: SSE (Server-Sent Events)",
      "level": 3,
      "blockId": "689c15dc"
    },
    {
      "id": "pattern-4-chat-interface-multiple-messages",
      "text": "Pattern 4: Chat Interface (Multiple Messages)",
      "level": 3,
      "blockId": "351a0b22"
    },
    {
      "id": "custom-components",
      "text": "Custom Components",
      "level": 2,
      "blockId": "64bfd45a"
    },
    {
      "id": "override-block-components",
      "text": "Override Block Components",
      "level": 3,
      "blockId": "2a06f905"
    },
    {
      "id": "mermaid-diagrams-optional",
      "text": "Mermaid Diagrams (Optional)",
      "level": 3,
      "blockId": "48aa9520"
    },
    {
      "id": "override-inline-components",
      "text": "Override Inline Components",
      "level": 3,
      "blockId": "2cee49a"
    },
    {
      "id": "shadcn-integration-example",
      "text": "ShadCN Integration Example",
      "level": 3,
      "blockId": "1afc0679"
    },
    {
      "id": "custom-plugins",
      "text": "Custom Plugins",
      "level": 2,
      "blockId": "3b06f5bd"
    },
    {
      "id": "mdx-integration",
      "text": "MDX Integration",
      "level": 2,
      "blockId": "7b710d3b"
    },
    {
      "id": "basic-mdx-setup",
      "text": "Basic MDX Setup",
      "level": 3,
      "blockId": "6e0a3704"
    },
    {
      "id": "server-vs-worker-mdx-parity-and-strategy",
      "text": "Server vs Worker MDX ‚Äî Parity and Strategy",
      "level": 3,
      "blockId": "13e2bb7c"
    },
    {
      "id": "mdx-with-server-compilation",
      "text": "MDX with Server Compilation",
      "level": 3,
      "blockId": "301829ca"
    },
    {
      "id": "feature-flags-math-html-mdx-format-anticipation",
      "text": "Feature Flags: Math, HTML, MDX, Format Anticipation",
      "level": 3,
      "blockId": "6a38c646"
    },
    {
      "id": "math-delimiters-markdown-vs-mdx",
      "text": "Math Delimiters (Markdown vs MDX)",
      "level": 3,
      "blockId": "644c2ed9"
    },
    {
      "id": "performance-optimization",
      "text": "Performance Optimization",
      "level": 2,
      "blockId": "513855f6"
    },
    {
      "id": "1-prewarm-languages",
      "text": "1. Prewarm Languages",
      "level": 3,
      "blockId": "8a0719a"
    },
    {
      "id": "2-monitor-performance",
      "text": "2. Monitor Performance",
      "level": 3,
      "blockId": "731b7b19"
    },
    {
      "id": "3-adjust-scheduling",
      "text": "3. Adjust Scheduling",
      "level": 3,
      "blockId": "2a17edfd"
    },
    {
      "id": "4-use-imperative-handle-for-control",
      "text": "4. Use Imperative Handle for Control",
      "level": 3,
      "blockId": "6a294e3a"
    },
    {
      "id": "common-patterns",
      "text": "Common Patterns",
      "level": 2,
      "blockId": "22393c4c"
    },
    {
      "id": "pattern-0-streaming-polish-caret-link-safety-deferred-blocks",
      "text": "Pattern 0: Streaming polish (caret + link safety + deferred blocks)",
      "level": 3,
      "blockId": "acc1e8a"
    },
    {
      "id": "pattern-1-chat-interface-with-message-history",
      "text": "Pattern 1: Chat Interface with Message History",
      "level": 3,
      "blockId": "615057e2"
    },
    {
      "id": "pattern-2-code-block-with-copy-button",
      "text": "Pattern 2: Code Block with Copy Button",
      "level": 3,
      "blockId": "4daf2cbe"
    },
    {
      "id": "pattern-3-loading-states",
      "text": "Pattern 3: Loading States",
      "level": 3,
      "blockId": "6078b9b"
    },
    {
      "id": "pattern-4-error-handling",
      "text": "Pattern 4: Error Handling",
      "level": 3,
      "blockId": "7c58f0dd"
    },
    {
      "id": "complete-examples",
      "text": "Complete Examples",
      "level": 2,
      "blockId": "1ee811a5"
    },
    {
      "id": "example-1-full-featured-chat-interface",
      "text": "Example 1: Full-Featured Chat Interface",
      "level": 3,
      "blockId": "59a0ecfa"
    },
    {
      "id": "example-2-documentation-viewer-with-toc",
      "text": "Example 2: Documentation Viewer with TOC",
      "level": 3,
      "blockId": "51327d26"
    },
    {
      "id": "troubleshooting",
      "text": "Troubleshooting",
      "level": 2,
      "blockId": "232f9322"
    },
    {
      "id": "worker-not-loading",
      "text": "Worker Not Loading",
      "level": 3,
      "blockId": "bc27560"
    },
    {
      "id": "performance-issues",
      "text": "Performance Issues",
      "level": 3,
      "blockId": "1ebf00e0"
    },
    {
      "id": "custom-plugins-not-working",
      "text": "Custom Plugins Not Working",
      "level": 3,
      "blockId": "2abf173"
    },
    {
      "id": "mdx-not-compiling",
      "text": "MDX Not Compiling",
      "level": 3,
      "blockId": "5daca79f"
    },
    {
      "id": "colors-not-showing-in-code-blocks",
      "text": "Colors Not Showing in Code Blocks",
      "level": 3,
      "blockId": "6666a203"
    },
    {
      "id": "next-steps",
      "text": "Next Steps",
      "level": 2,
      "blockId": "5485dfc0"
    },
    {
      "id": "summary",
      "text": "Summary",
      "level": 2,
      "blockId": "70605f7e"
    }
  ],
  "init": {
    "docPlugins": {
      "tables": true,
      "html": true,
      "mdx": true,
      "math": true,
      "footnotes": true,
      "callouts": true
    },
    "mdx": {
      "compileMode": "server"
    },
    "prewarmLangs": [
      "typescript",
      "tsx",
      "javascript",
      "json",
      "bash",
      "diff"
    ]
  }
}